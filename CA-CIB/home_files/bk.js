
(function(){if(!document.getElementsByClassName){document.getElementsByClassName=function(cl,tag){var els,matches=[],i=0,len,regex=new RegExp('(?:\\s|^)'+cl+'(?:\\s|$)');els=document.getElementsByTagName(tag||"*");if(!els[0]){return false;}
for(len=els.length;i<len;i++){if(els[i].className.match(regex)){matches.push(els[i]);}}
return matches;};}
if(typeof String.prototype.startsWith!='function'){String.prototype.startsWith=function(str){return this.substring(0,str.length)===str;};}
var Bk={hideHeader:false,hideFooter:false,init:function(args){if(args.hideHeader&&args.hideHeader==true){Bk.hideHeader=true;var header=Bk.Header.find();Bk.Dom.hideInPage(header);}
if(args.hideFooter&&args.hideFooter==true){Bk.hideFooter=true;var footer=Bk.Footer.find();Bk.Dom.hideInPage(footer);}}};Bk.Log=(function(){var self={};var _void=function(){};self.logLevel="error";self.nativeConsole=undefined;self.storeNativeConsole=function(){if(!window.console){return;}
self.nativeConsole=window.console;};self.overrideNativeConsole=function(){if(!window.console){return;}
switch(self.logLevel){case"debug":break;case"info":window.console.log=window.console.debug=_void;break;case"warn":window.console.log=window.console.debug=window.console.info=_void;break;case"error":window.console.log=window.console.debug=window.console.info=window.console.warn=_void;break;case"off":window.console.log=window.console.debug=window.console.info=window.console.warn=window.console.error=_void;break;default:console.warn("target.js.logLevel did not match debug|info|warn|error|off, assuming 'error' level");self.logLevel="error";window.console.log=window.console.debug=window.console.info=window.console.warn=_void;}};(function(){if(!window.console){window.console={};}
if(!window.console.log){window.console.log=function(){};}
if(!window.console.debug){window.console.debug=window.console.log;}
if(!window.console.info){window.console.info=window.console.log;}
if(!window.console.warn){window.console.warn=window.console.log;}
if(!window.console.error){window.console.error=window.console.log;}
self.storeNativeConsole();self.overrideNativeConsole();})();return self;})();Wopernizr=(function(){var self={};self.init=function(){};var vendorPrefixes='webkit Moz O ms'.split(' ');self.whichTransitionEvent=function(){var t;var el=document.createElement('fakeelement');var transitions={'transition':'transitionend','OTransition':'otransitionend','MSTransition':'msTransitionEnd','MozTransition':'transitionend','WebkitTransition':'webkitTransitionEnd'};if(Bk.Util.isAndroidStock()){transitions={'OTransition':'otransitionend','MSTransition':'msTransitionEnd','MozTransition':'transitionend','WebkitTransition':'webkitTransitionEnd','transition':'transitionend'};}
for(t in transitions){if(el.style[t]!==undefined){return transitions[t];}}};self.whichAnimationEvent=function(){var t;var el=document.createElement('fakeelement');var transitions={'animation':'animationend','WebkitAnimation':'webkitAnimationEnd'}
for(t in transitions){if(el.style[t]!==undefined){return transitions[t];}}};self.detect=function(prop){var ele=document.createElement("detect");var ucProp=prop.charAt(0).toUpperCase()+prop.substr(1);All=(prop+' '+vendorPrefixes.join(ucProp+' ')+ucProp).split(' ');for(var n=0,np=All.length;n<np;n++){if(ele.style[All[n]]==="")return All[n];}
return null;};return self;})();if(!window.Bk){window.Bk=Bk;}
if(window.ActiveXObject){if(!document.ELEMENT_NODE){document.ELEMENT_NODE=1;document.ATTRIBUTE_NODE=2;document.TEXT_NODE=3;document.CDATA_SECTION_NODE=4;document.ENTITY_REFERENCE_NODE=5;document.ENTITY_NODE=6;document.PROCESSING_INSTRUCTION_NODE=7;document.COMMENT_NODE=8;document.DOCUMENT_NODE=9;document.DOCUMENT_TYPE_NODE=10;document.DOCUMENT_FRAGMENT_NODE=11;document.NOTATION_NODE=12;}
document._importNode=function(node,allChildren){switch(node.nodeType){case document.ELEMENT_NODE:var newNode=document.createElement(node.nodeName);if(node.nodeName.toLowerCase()==='input'){var value=node.getAttribute('value');}
if(node.attributes&&node.attributes.length>0){var attrsLength=node.attributes.length;for(var i=0;i<attrsLength;i++){newNode.setAttribute(node.attributes[i].nodeName,node.getAttribute(node.attributes[i].nodeName));}
if(value){newNode.value=value;}}
if(allChildren&&node.childNodes&&node.childNodes.length>0){var childNodesLength=node.childNodes.length;for(var i=0;i<childNodesLength;i++){newNode.appendChild(document._importNode(node.childNodes[i],allChildren));}}
return newNode;break;case document.TEXT_NODE:case document.CDATA_SECTION_NODE:case document.COMMENT_NODE:return document.createTextNode(node.nodeValue);break;}};}
Bk.Event=(function(){"use strict";var self={};self.PAGE_LOADED="load";self.PAGE_UNLOADED="unload";self.BK_PAGE_LOADED="bkPageLoaded";self.BK_PAGE_UNLOADED="bkPageUnloaded";self.BK_SCRIPTS_LOADED="bkScriptsLoaded";self.BK_ANIMATION_STARTED="bkAnimationStarted";self.BK_ANIMATION_COMPLETED="bkAnimationCompleted";self.BK_TRANSITION_STARTED="bkTransitionStarted";self.BK_TRANSITION_COMPLETED="bkTransitionCompleted";self.BK_HEADER_LOADED="bkHeaderLoaded";self.BK_FOOTER_LOADED="bkFooterLoaded";self.BK_BODY_LOADED="bkBodyLoaded";self.BK_LOCATION_CHANGED="bkLocationChanged";self.BK_REMOTE_DOCUMENT_RETRIEVED="bkRemoteDocumentRetrieved";self.BK_PAGE_LOAD_REQUEST_SUCCEEDED="bkPageLoadRequestSucceeded";self.BK_PAGE_LOAD_REQUEST_FAILED="bkPageLoadRequestFailed";self.BK_PAGE_LOAD_REQUEST_TIMEOUT="bkPageLoadRequestTimeout";self.BK_TABLE_SORT_LOADED="tableSort";self.BK_POPUP_BEFORE_OPEN="bkPopupBeforeOpen";self.BK_POPUP_ON_CLOSE="bkPopupOnClose";self.BK_CALENDAR_BEFORE_OPEN="bkCalendarBeforeOpen";self.BK_CALENDAR_ON_CLOSE="bkCalendarOnClose";self.BK_NODE_LOADED="bknodeloaded";self.BK_CHART_BUILT="BkChartBuilt";self.onOrientationChange=function(callback){var evtName="resize";if("orientation"in window&&"onorientationchange"in window){evtName="orientationchange";}
self.addListener(evtName,window,callback);return evtName;};self.fireEvent=function(eventName,data){var evt=document.createEvent("Event");evt.data=data;evt.initEvent(eventName,true,true);document.dispatchEvent(evt);};self.fireBkPageLoaded=function(isAjax){self.fireEvent(self.BK_PAGE_LOADED,{isAjax:isAjax});};self.fireBkPageUnloaded=function(){Bk.animation.status.init();self.fireEvent(self.BK_PAGE_UNLOADED);};self.fireBkTransitionStarted=function(){self.fireEvent(self.BK_TRANSITION_STARTED);};self.fireBkTransitionCompleted=function(data){self.fireEvent(self.BK_TRANSITION_COMPLETED,data);};self.fireBkAnimationStarted=function(args){self.fireEvent(self.BK_ANIMATION_STARTED,args);};self.fireBkAnimationCompleted=function(args){self.fireEvent(self.BK_ANIMATION_COMPLETED,args);};self.fireBkScriptsLoaded=function(){self.fireEvent(Bk.Event.BK_SCRIPTS_LOADED);};self.fireBkHeaderLoaded=function(header){if(Bk.Header.isPresent()){self.fireEvent(self.BK_HEADER_LOADED,{header:header});}};self.fireBkFooterLoaded=function(footer){if(Bk.Footer.isPresent()){self.fireEvent(self.BK_FOOTER_LOADED,{footer:footer});}};self.fireBkBodyLoaded=function(body){self.fireEvent(self.BK_BODY_LOADED,{body:body});};self.fireBkLocationChanged=function(hash){self.fireEvent(self.BK_LOCATION_CHANGED,{hash:hash});};self.fireBkAjaxSuccess=function(xhr){var data={xhr:xhr,document:Bk.Ajax.getXMLResponse(xhr)}
self.fireEvent(self.BK_PAGE_LOAD_REQUEST_SUCCEEDED,data);};self.fireBkAjaxError=function(xhr){self.fireEvent(self.BK_PAGE_LOAD_REQUEST_FAILED,{xhr:xhr});};self.fireBkRemoteDocumentRetrieved=function(remoteDocument){self.fireEvent(self.BK_REMOTE_DOCUMENT_RETRIEVED,{remoteDocument:remoteDocument});};self.createAndDispatchEvent=function(eventName,elem){var evt=document.createEvent("Event");evt.initEvent(eventName,true,true);if(elem){elem.dispatchEvent(evt);return;}
document.dispatchEvent(evt);};self.getTarget=function(e){var event=e||window.event;return event.currentTarget||event.srcElement;};self.preventDefault=function(e){var event=e||window.event;if(event.preventDefault){event.preventDefault();}
else{event.returnValue=false;}};self.addListener=function(eventName,elt,callback){if(elt.addEventListener){elt.addEventListener(eventName,callback,false);}else if(elt.attachEvent){elt.attachEvent("on"+eventName,callback);}};self.removeListener=function(eventName,elt,callback){elt=elt||window;if(elt.removeEventListener){elt.removeEventListener(eventName,callback,false);}else if(elt.detachEvent){elt.detachEvent("on"+eventName,callback);}};(function(){var isLoad;var areBkScriptsLoaded;var isBkTransitionCompleted;var setup=function(){isLoad=false;areBkScriptsLoaded=false;isBkTransitionCompleted=false;}
setup();var bkEventsHandler=function(evt){if(evt.type===self.PAGE_UNLOADED||evt.type===self.BK_PAGE_UNLOADED){isLoad=false;areBkScriptsLoaded=false;isBkTransitionCompleted=false;console.debug("Event fired: bkPageUnloaded");}else{areBkScriptsLoaded=(evt.type===self.BK_SCRIPTS_LOADED)?true:areBkScriptsLoaded;isBkTransitionCompleted=(evt.type===self.BK_TRANSITION_COMPLETED)?true:isBkTransitionCompleted;if(isBkTransitionCompleted){console.debug("Event fired: bkTransitionCompleted");}
isLoad=(evt.type===self.PAGE_LOADED)?true:isLoad;if(isLoad){self.fireBkPageLoaded(false);console.debug("Event fired: bkPageLoaded");setup();}
if(areBkScriptsLoaded&&isBkTransitionCompleted){self.fireBkPageLoaded(true);console.debug("Event fired: bkPageLoaded");setup();}}}
self.addListener(self.PAGE_LOADED,window,bkEventsHandler);self.addListener(self.PAGE_UNLOADED,window,bkEventsHandler);self.addListener(self.BK_SCRIPTS_LOADED,window,bkEventsHandler);self.addListener(self.BK_TRANSITION_COMPLETED,window,bkEventsHandler);self.addListener(self.BK_PAGE_UNLOADED,window,bkEventsHandler);}());return self;}());Bk.Event.Delegator=(function(){"use strict";var self={};var _lock=false;var _eventHandlers=[];var _isBack=function(elt){return elt.getAttribute("data-bk-rel")==="back";};var _isAjaxDisabled=function(elt){if(elt.form){var form=Bk.Dom.getElementById(elt.form.id);if(form){if(_isAjaxDisabled(form)){return true;}}}
return elt.getAttribute("data-bk-ajax")==="false";};var _isOnclickAlreadyDefined=function(elt){return elt.getAttribute("onclick")!==null;};var _isLinkAbsolute=function(elt){return(elt.getAttribute("href")!==null)&&(elt.getAttribute("href").match("^[a-z]+:"));};self.registerEventHandler=function(eventHandler){if(typeof eventHandler!=="function"){console.warn("Event handler should be a function.");return;}
if(_eventHandlers.indexOf(eventHandler)===-1){_eventHandlers.push(eventHandler);}else{_eventHandlers[_eventHandlers.indexOf(eventHandler)]=eventHandler;}};self.unRegisterEventHandler=function(eventHandler){if(typeof eventHandler!=="function"){console.warn("Event handler should be a function.");return;}
var index=_eventHandlers.indexOf(eventHandler);if(index>-1){_eventHandlers.splice(index,1);}};self.getLock=function(){return _lock;}
self.handleLinkClickEvent=function(t,e){if(_isAjaxDisabled(t)||_isOnclickAlreadyDefined(t)||!t.getAttribute("href")||_isLinkAbsolute(t)||t.getAttribute("data-bk-role")){return;}
if(e){Bk.Event.preventDefault(e);}
if(t.getAttribute("href")&&t.getAttribute("href").indexOf("#")==0){if(t.getAttribute("href").split("#")[1]!=""){var _anchor=t.getAttribute("href").split("#")[1];Bk.Util.scrollTo(_anchor);return;}else if(t.getAttribute("href")==="#"){window.scrollTo(0,0);return;}}
if(_lock){return;}
if(_isBack(t)){window.history.back();}else{Bk.initContext();var transition=Bk.TransitionFactory.buildAutomaticTransition({link:t});transition.process();Bk.releaseContext();}};self.handleButtonClickEvent=function(t,e){if(_isAjaxDisabled(t)||_isOnclickAlreadyDefined(t)||t.disabled){return;}
Bk.Event.preventDefault(e);if(_lock){return;}
var form=Bk.Dom.getElementById(t.form.id);Bk.initContext();var transition=Bk.TransitionFactory.buildAutomaticTransition({form:form,submit:t});transition.process();Bk.releaseContext();};self.isTransitionAlreadyProcessing=function(){return _lock;};self.clickListener=function(e){if(e.button&&e.button>1){return;}
e=e||window.event;var target=e.target||e.srcElement;for(var i=0;i<_eventHandlers.length;i++){var eventHandler=_eventHandlers[i];if(eventHandler(target)){Bk.Event.preventDefault(e);return;}}
if(target.nodeName.toLowerCase()=="input"){var type=target.getAttribute("type");if(type&&(type.toLowerCase()==="image"||type.toLowerCase()==="submit")){self.handleButtonClickEvent(target,e);}
return;}
if(target.nodeName.toLowerCase()=="a"){self.handleLinkClickEvent(target,e);return;}
var link=Bk.Dom.findParentNode("a",target);if(link){self.handleLinkClickEvent(link,e);return;}
return false;};(function(){Bk.Event.addListener(Bk.Event.BK_PAGE_LOADED,document,function(){_eventHandlers.splice();});Bk.Event.addListener(Bk.Event.BK_TRANSITION_STARTED,document,function(){_lock=true;});Bk.Event.addListener(Bk.Event.BK_TRANSITION_COMPLETED,document,function(){_lock=false;});Bk.Event.addListener("click",document,self.clickListener);}());return self;}());Bk.onFirstPageLoaded=function(fct){Bk.Event.addListener(Bk.Event.BK_PAGE_LOADED,document,function(evt){if(!evt.data.isAjax){fct();}});};Bk.onRemoteDocumentRetrieved=function(fct){Bk.Event.addListener(Bk.Event.BK_REMOTE_DOCUMENT_RETRIEVED,document,fct);};Bk.onPageLoaded=function(fct){Bk.Event.addListener(Bk.Event.BK_PAGE_LOADED,document,fct);};Bk.onPageUnloaded=function(fct){Bk.Event.addListener(Bk.Event.BK_PAGE_UNLOADED,document,fct);};Bk.onBkBodyLoaded=function(fct){Bk.Event.addListener(Bk.Event.BK_BODY_LOADED,document,function(evt){fct(evt.data.body);});};Bk.onBkHeaderLoaded=function(fct){Bk.Event.addListener(Bk.Event.BK_HEADER_LOADED,document,fct);};Bk.onBkFooterLoaded=function(fct){Bk.Event.addListener(Bk.Event.BK_FOOTER_LOADED,document,fct);};Bk.bind=function(evt,node,fct){Bk.Event.addListener(evt,node,fct);};Bk.bindOnce=function(evt,node,fct){var callback=function(e){Bk.Event.removeListener(evt,node,callback);fct(e);};Bk.Event.addListener(evt,node,callback);};Bk.onePageLoaded=function(fct){var callback=function(){fct();Bk.Event.removeListener(Bk.Event.BK_PAGE_LOADED,document,callback);};Bk.Event.addListener(Bk.Event.BK_PAGE_LOADED,document,callback);};Bk.onePageUnloaded=function(callback){Bk.Event.addListener(Bk.Event.BK_PAGE_UNLOADED,document,function _cb(){callback();Bk.Event.removeListener(Bk.Event.BK_PAGE_UNLOADED,document,_cb);});};Bk.onPluginReady=function(pluginName,fct){var e=null;if(pluginName==='tablesort'){if(Bk.Plugins&&Bk.Plugins['tablesort']===true){fct();}else{e=Bk.Event.BK_TABLE_SORT_LOADED;Bk.bindOnce(e,document,fct);}}};Bk.on=function(event,cb,ele){var element=ele||document;Bk.Event.addListener(event,element,cb);};Bk.life=function(event,handler){Bk.Event.addListener(event,document,handler);Bk.bindOnce(Bk.Event.BK_PAGE_UNLOADED,document,function(){Bk.Event.removeListener(event,document,handler);});};Bk.Overlay=(function(){var self={};var Cs={};Cs.ID="bk-overlay";Cs.CLOSE="bk-overlay-closed";Cs.OPEN="bk-overlay-open";self.setOverlaySize=function(){var _overlay=Bk.Dom.getElementById(Cs.ID);_overlay.style.height=0;_overlay.style.height=Bk.Util.getDocumentHeight()+'px';};self.showOverlay=function(){var _overlay=Bk.Dom.getElementById(Cs.ID);Bk.Dom.removeClass(_overlay,Cs.CLOSE);Bk.Dom.addClass(_overlay,Cs.OPEN);self.setOverlaySize();if(document.body.style.webkitFilter!==undefined){if(Bk.Header.isPresent()){Bk.Dom.addClass(document.getElementById("bk-header"),"bk-blur");}
if(Bk.Footer.isPresent()){Bk.Dom.addClass(document.getElementById("bk-footer"),"bk-blur");}
Bk.Dom.addClass(document.getElementById("bk-body"),"bk-blur");}};self.hideOverlay=function(){var _overlay=Bk.Dom.getElementById(Cs.ID);Bk.Dom.removeClass(_overlay,Cs.OPEN);Bk.Dom.addClass(_overlay,Cs.CLOSE);_overlay.style.height=0;if(document.body.style.webkitFilter!==undefined){if(Bk.Header.isPresent()){Bk.Dom.removeClass(document.getElementById("bk-header"),"bk-blur");}
if(Bk.Footer.isPresent()){Bk.Dom.removeClass(document.getElementById("bk-footer"),"bk-blur");}
Bk.Dom.removeClass(document.getElementById("bk-body"),"bk-blur");}};return self;})();Bk.Body=(function(){"use strict";var self={};var id="bk-body";self.id=id;self.getId=function(){return id;};self.extract=function(remoteDocument){return Bk.Dom.importContainer(remoteDocument,id);};self.load=function(){return Bk.Dom.getElementById(id);};self.matches=function(otherId){return id===otherId;};return self;}());Bk.Header=(function(){"use strict";var self={};var ID="bk-header";var _addClass=function(){if(document.getElementById(ID)){Bk.Dom.addClass(document.getElementById(ID),"bk-fixed");}};var _removeClass=function(){if(document.getElementById(ID)){Bk.Dom.removeClass(document.getElementById(ID),"bk-fixed");}};var _addPadding=function(body){var height=self.height()+"px";body.style.setProperty("padding-top",height);};var _removePadding=function(body){body.style.setProperty("padding-top","0px");};self.isFixed=function(){var header=document.getElementById(ID);if(header){return header.getAttribute("data-bk-position")==="fixed";}
return false;};self.isPresent=function(){return document.getElementById(ID)!==null;};self.find=function(){return document.getElementById(ID);};self.height=function(){if(document.getElementById(ID)){return document.getElementById(ID).clientHeight;}
return 0;}
self.update=function(remoteDocument){if(Bk.hideHeader){return;}
var remote=Bk.Dom.importContainer(remoteDocument,ID);if(document.getElementById(ID)){if(remote){document.getElementById(ID).parentNode.replaceChild(remote,document.getElementById(ID));}else{document.getElementById(ID).parentNode.removeChild(document.getElementById(ID));}}else if(remote){document.body.insertBefore(remote,document.body.firstChild);}
Bk.Event.fireBkHeaderLoaded(document.getElementById(ID));};self.fixed=function(){_addClass();var bkBody=document.getElementById("bk-body");_addPadding(bkBody);};self.unfixed=function(){_removeClass();var bkBody=document.getElementById("bk-body");_removePadding(bkBody);};(function(){Bk.onFirstPageLoaded(function(){if(self.isFixed()){self.fixed();}
Bk.Event.onOrientationChange(function(){if(self.isFixed()){self.fixed();}});});Bk.onBkHeaderLoaded(function(){if(self.isFixed()){_addClass();}});Bk.onBkBodyLoaded(function(body){if(self.isFixed()){_addPadding(body);}});var fixAndroid4OnOverlayOpen=function(){if(Bk.Util.isAndroid("4.0")&&self.isFixed()){console.debug("Workaround Android 4.0: disabling header fixed position before pop up opening.");self.unfixed();}};var fixAndroid4OnOverlayClose=function(){if(Bk.Util.isAndroid("4.0")&&self.isFixed()){console.debug("Workaround Android 4.0: enabling header fixed position after pop up closing.");self.fixed();}};Bk.bind(Bk.Event.BK_POPUP_BEFORE_OPEN,document,fixAndroid4OnOverlayOpen);Bk.bind(Bk.Event.BK_POPUP_ON_CLOSE,document,fixAndroid4OnOverlayClose);Bk.bind(Bk.Event.BK_CALENDAR_BEFORE_OPEN,document,fixAndroid4OnOverlayOpen);Bk.bind(Bk.Event.BK_CALENDAR_ON_CLOSE,document,fixAndroid4OnOverlayClose);})();return self;}());Bk.Footer=(function(){"use strict";var self={};var ID="bk-footer";var _addClass=function(){if(document.getElementById(ID)){Bk.Dom.addClass(document.getElementById(ID),"bk-fixed");}};var _removeClass=function(){if(document.getElementById(ID)){Bk.Dom.removeClass(document.getElementById(ID),"bk-fixed");}};var _addPadding=function(body){var height=self.height()+"px";body.style.setProperty("padding-bottom",height);};var _removePadding=function(body){body.style.setProperty("padding-bottom","0px");};self.isFixed=function(){var footer=document.getElementById(ID);if(footer){return footer.getAttribute("data-bk-position")==="fixed";}
return false;};self.isPresent=function(){return document.getElementById(ID)!==null;};self.find=function(){return document.getElementById(ID);};self.height=function(){if(document.getElementById(ID)){return document.getElementById(ID).clientHeight;}
return 0;};self.update=function(remoteDocument){if(Bk.hideFooter){return;}
var remote=Bk.Dom.importContainer(remoteDocument,ID);if(document.getElementById(ID)){if(remote){document.getElementById(ID).parentNode.replaceChild(remote,document.getElementById(ID));}else{document.getElementById(ID).parentNode.removeChild(document.getElementById(ID));}}else if(remote){document.body.insertBefore(remote,Bk.Loader.load().nextSibling);}
Bk.Event.fireBkFooterLoaded(document.getElementById(ID));};self.fixed=function(){_addClass();var bkBody=document.getElementById("bk-body");_addPadding(bkBody);};self.unfixed=function(){_removeClass();var bkBody=document.getElementById("bk-body");_removePadding(bkBody);};(function(){Bk.onFirstPageLoaded(function(){if(self.isFixed()){self.fixed();}});Bk.onBkFooterLoaded(function(){if(self.isFixed()){_addClass();}});Bk.onBkBodyLoaded(function(e){if(self.isFixed()){_addPadding(e.data.body);}});Bk.Event.onOrientationChange(function(){if(self.isFixed()){self.fixed();}});var fixAndroid4OnOverlayOpen=function(){if(Bk.Util.isAndroid("4.0")&&self.isFixed()){console.debug("Workaround Android 4.0: disabling footer fixed position before pop up opening.");self.unfixed();}};var fixAndroid4OnOverlayClose=function(){if(Bk.Util.isAndroid("4.0")&&self.isFixed()){console.debug("Workaround Android 4.0: enabling footer fixed position after pop up closing.");self.fixed();}};Bk.bind(Bk.Event.BK_POPUP_BEFORE_OPEN,document,fixAndroid4OnOverlayOpen);Bk.bind(Bk.Event.BK_POPUP_ON_CLOSE,document,fixAndroid4OnOverlayClose);Bk.bind(Bk.Event.BK_CALENDAR_BEFORE_OPEN,document,fixAndroid4OnOverlayOpen);Bk.bind(Bk.Event.BK_CALENDAR_ON_CLOSE,document,fixAndroid4OnOverlayClose);})();return self;})();Bk.Loader=(function(){"use strict";var self={};var id="bk-main-loader";var node;Bk.onPageLoaded(function(){node=Bk.Dom.getElementById(id);});self.getId=function(){return id;};self.isPresent=function(){return node!==null;};self.load=function(){return Bk.Dom.getElementById(id);};self.update=function(newLoaderEle){var oldLoaderEle=document.getElementById(id);if(newLoaderEle){oldLoaderEle.parentNode.replaceChild(newLoaderEle,oldLoaderEle);}
node=newLoaderEle;};self.computeHeight=function(){var bkBody=Bk.Body.load();var bkHeader=Bk.Header.find();var bkFooter=Bk.Footer.find();var bkHeaderHeight=0,bkFooterHeight=0;if((bkHeader&&bkFooter&&bkBody)&&(Bk.Util.getScreenHeight()>bkBody.clientHeight)){return bkBody.clientHeight;}
if(bkHeader){bkHeaderHeight=bkHeader.clientHeight;}
if(bkFooter){bkFooterHeight=bkFooter.clientHeight;}
return Bk.Util.getScreenHeight()-(bkHeaderHeight+bkFooterHeight);};return self;}());var deltax="260px";var deltatransition=300;var breakpoint=1023;Bk.Aside=(function(){var asidescroll=null;var self={};var _orientationChangeEventName="";var _transformPropName=window.Wopernizr.detect('transform');var ASIDE_WRAPPER_ID="asidewrapper";var ASIDE_CONTENT_WRAPPER_ID="bk-aside-content-wrapper";var ASIDE_CONTENT_ID="bk-aside-content";var ASIDE_CONTENT_GLASS="bk-aside-glass";var ASIDE_MENU_ID="asidemenu";var _buildTransformValue=function(translation){if(Bk.Util.isAndroid("2.3")||Bk.Util.isAndroid("2.2")||Bk.Util.isAndroid("2.1")||Bk.Util.getInternetExplorerVersion()===9||Bk.Util.isOperaPresto()){return'translateX('+translation+')';}else{return'translate3d('+translation+' ,0 , 0)';}};self.asideGetStatus=function(){var asidemenu=document.getElementById(ASIDE_MENU_ID);if(!asidemenu){console.warn("Aside menu not found. Aborting!");return"absent";}
if(Bk.Dom.hasClass(asidemenu,"asidemenuopened")&&!(Bk.Dom.hasClass(asidemenu,"asidemenuclosed"))&&!(Bk.Dom.hasClass(asidemenu,"asidemenudefaultopened"))){return"opened";}else if(Bk.Dom.hasClass(asidemenu,"asidemenudefaultopened")&&!(Bk.Dom.hasClass(asidemenu,"asidemenuclosed"))&&!(Bk.Dom.hasClass(asidemenu,"asidemenuopened"))){return"defaultopened";}else if(Bk.Dom.hasClass(asidemenu,"asidemenuclosed")&&!(Bk.Dom.hasClass(asidemenu,"asidemenudefaultopened"))&&!(Bk.Dom.hasClass(asidemenu,"asidemenuopened"))){return"closed";}else{return"classesmixed";}};self.present=function(){return Bk.Dom.getElementById(ASIDE_MENU_ID)!==null;};self.updateColumn=function(remoteDocument){var remoteColumn=Bk.Dom.getElementById(ASIDE_MENU_ID,remoteDocument);var column=Bk.Dom.getElementById(ASIDE_MENU_ID);remoteColumn=Bk.Dom.importNode(remoteColumn,true);column.parentNode.replaceChild(remoteColumn,column);};self.extractPopupsToBody=function(remoteDocument){var popups=remoteDocument.getElementsByClassName("bk-popup-wrapper");popups.forEach(function(elem){var popup=Bk.Dom.importNode(elem,true);document.body.appendChild(popup);});};self.getComponents=function(){var components={};components.asideContentWrapperEle=document.getElementById(ASIDE_CONTENT_WRAPPER_ID);if(!components.asideContentWrapperEle){components.error="✘ Aside content wrapper not found!";return components;}
components.asideContentEle=document.getElementById(ASIDE_CONTENT_ID);if(!components.asideContentEle){components.error="✘ Aside content not found!";return components;}
components.asidemenu=document.getElementById(ASIDE_MENU_ID);if(!components.asidemenu){components.error="✘ Aside menu not found!";return components;}
return components;};_onOrientationChange=function(components){console.log("→ orientation change");if(window.innerWidth>breakpoint){self.flattenMenu(components);self.hackToKeepOutsiderElementsVisible(components);components.asidemenu.style.top="initial";var transformPropertyValue=_buildTransformValue(0);components.asideContentEle.style[_transformPropName]=components.asidemenu.style[_transformPropName]=transformPropertyValue;}else{self.resetHack(components);_disableGlass();_unsetAsideMenuTop();_setAsideMenuTop();if(window.innerWidth<=breakpoint&&Bk.Dom.hasClass(components.asidemenu,"asidemenuopened")){Bk.Dom.removeClass(components.asidemenu,"asidemenudefaultopened");}else if(window.innerWidth<=breakpoint&&!(Bk.Dom.hasClass(components.asidemenu,"asidemenuopened"))){Bk.Dom.removeClass(components.asidemenu,"asidemenudefaultopened");Bk.Dom.addClass(components.asidemenu,"asidemenuclosed");}}
setTimeout(function(){_enableScroll();_enableGlass();},300);};self.onOrientationChange=function(){var components=self.getComponents();if(components.error){console.log(components.error);return;}
if(Bk.Util.isAndroidStock()){setTimeout(function(){_onOrientationChange(components);},250);}else{_onOrientationChange(components);}};self.flattenMenu=function(components){var menu=components.asidemenu;var wrapper=menu.parentNode;Bk.Dom.addClass(menu,"asidemenudefaultopened");Bk.Dom.removeClass(menu,"asidemenuopened");Bk.Dom.removeClass(menu,"asidemenuclosed");if(wrapper.style.overflow==="hidden"){wrapper.style.overflow="visible";}};self.registerMenuBtnClickListener=function(){var asideBtns=Bk.Dom.getElementsByAttribute(document.body,"*","data-bk-role","slide-menu-button");if(!asideBtns||!asideBtns.length){console.warn("Aside button(s) not found. Aborting!");return;}
Bk.Event.Delegator.registerEventHandler(function(target){var asideBtns=Bk.Dom.getElementsByAttribute(document.body,"*","data-bk-role","slide-menu-button");for(var i=0;i<asideBtns.length;i++){if(target===asideBtns[i]){Bk.Aside.asideBtnClickListener();return true;}
var link=Bk.Dom.findParentNode("a",target);if(link===asideBtns[i]){Bk.Aside.asideBtnClickListener();return true;}}});};self.asideBtnClickListener=function(){var asideContentWrapperEle=document.getElementById(ASIDE_CONTENT_WRAPPER_ID);var asidemenu=document.getElementById(ASIDE_MENU_ID);if(asideContentWrapperEle!==null&&asidemenu!==null){if(Bk.Dom.hasClass(asidemenu,"asidemenuclosed")&&window.innerWidth<=breakpoint){Bk.Aside.open();}else if(Bk.Dom.hasClass(asidemenu,"asidemenuopened")&&window.innerWidth<=breakpoint){Bk.Aside.close();}}else{console.log("aside menu/content not found!");}
return false;};var _getAvailableHeightForGlass=function(){var underHeaderHeight=window.innerHeight;if(Bk.Header.isPresent()){underHeaderHeight-=(Bk.Header.height()-window.pageYOffset);}
return Math.max(underHeaderHeight,document.getElementById(ASIDE_CONTENT_ID).offsetHeight)+"px";}
var _enableGlass=function(openAction){if(window.innerWidth>breakpoint){return;}
var asideWrapper=document.getElementById(ASIDE_WRAPPER_ID);if(!document.getElementById(ASIDE_CONTENT_GLASS)){var glass=document.createElement("div");glass.id=ASIDE_CONTENT_GLASS;glass.style.width=(document.body.clientWidth-260)+"px";glass.style.height=_getAvailableHeightForGlass();asideWrapper.appendChild(glass);var invokeClose=function(e){e.preventDefault();e.stopPropagation();Bk.Aside.close();};if(Bk.Util.isAndroidStock()){glass.addEventListener("touchmove",invokeClose);}else{glass.addEventListener("touchstart",invokeClose);}
glass.addEventListener("MSPointerDown",invokeClose);glass.addEventListener("pointerdown",invokeClose);glass.addEventListener("click",invokeClose);}else{document.getElementById(ASIDE_CONTENT_GLASS).style.width=(document.body.clientWidth-260)+"px";document.getElementById(ASIDE_CONTENT_GLASS).style.height=_getAvailableHeightForGlass();}};var _disableGlass=function(){var glass=document.getElementById(ASIDE_CONTENT_GLASS);if(glass){glass.parentNode.removeChild(glass)}}
var _setAsideMenuTop=function(){var asidemenu=document.getElementById(ASIDE_MENU_ID);var bodyScrollTop=Bk.Util.getScrollOffset();if(Bk.Header.isFixed()){asidemenu.style.top=bodyScrollTop+"px";}
else if(bodyScrollTop<=Bk.Header.height()){asidemenu.style.top="0px";}
else{asidemenu.style.top=bodyScrollTop-Bk.Header.height()+"px";}}
var _unsetAsideMenuTop=function(){var asidemenu=document.getElementById(ASIDE_MENU_ID);asidemenu.style.top="0px";}
var _enableScroll=function(){var asidemenu=document.getElementById(ASIDE_MENU_ID);if(asidemenu.getAttribute("data-bk-scrollable")==='true'){var previousY;if(asidescroll){previousY=asidescroll.y;asidescroll.destroy();}
asidescroll=new IScroll('#'+ASIDE_MENU_ID,{click:true,mouseWheel:true,startY:previousY?previousY:0,bindToWrapper:true});var max=window.innerHeight;asidemenu.style.height=max+"px";var scrollerHeight=document.getElementById("asidescroller").offsetHeight;var bodyScrollTop=Bk.Util.getScrollOffset();if(Bk.Header.isFixed()){scrollerHeight+=bodyScrollTop;}
else if(bodyScrollTop>Bk.Header.height()){scrollerHeight+=bodyScrollTop-Bk.Header.height();}
if(Bk.Header.isPresent()){scrollerHeight+=Bk.Header.height();}
if(Bk.Footer.isFixed()){scrollerHeight+=Bk.Footer.height();}
var scrollamount=asidemenu.clientHeight-scrollerHeight;var scrollTop=Bk.Util.getScrollOffset()-(document.documentElement.clientTop||0);scrollamount+=scrollTop;if(scrollamount<0){asidescroll.maxScrollY=scrollamount;asidescroll.hasVerticalScroll=true;}}};self.open=function(){var asideContentEle=document.getElementById(ASIDE_CONTENT_ID);if(!asideContentEle){console.warn("Aside content not found. Aborting!");return;}
var asidemenu=document.getElementById(ASIDE_MENU_ID);if(!asidemenu){console.warn("Aside menu not found. Aborting!");return;}
Bk.Dom.removeClass(asidemenu,"asidemenuclosed");Bk.Dom.removeClass(asidemenu,"asidemenudefaultopened");var asidewrapper=document.getElementById("asidewrapper");asidewrapper.style.overflow="visible";var transformPropertyValue=_buildTransformValue(deltax);window.requestAnimationFrame(function(){_setAsideMenuTop();asidemenu.style[_transformPropName]=asideContentEle.style[_transformPropName]=transformPropertyValue;});_onOpen(asidemenu);return false;};var _onOpen=function(asidemenu){setTimeout(function(){Bk.Dom.addClass(asidemenu,"asidemenuopened");if(asidemenu.getAttribute("data-bk-scrollable")==='true'){var asidewrapper=document.getElementById("asidewrapper");asidewrapper.style.overflow="visible";}
_enableScroll();_enableGlass(true);},deltatransition);if(asidemenu.getAttribute("data-bk-scrollable")==='true'){document.addEventListener('touchmove',Bk.Event.preventDefault,false);}};self.close=function(){var asideContentEle=document.getElementById(ASIDE_CONTENT_ID);if(!asideContentEle){console.warn("Aside content not found. Aborting!");return;}
var asidemenu=document.getElementById(ASIDE_MENU_ID);if(!asidemenu){console.warn("Aside menu not found. Aborting!");return;}
Bk.Dom.removeClass(asidemenu,"asidemenuopened");Bk.Dom.removeClass(asidemenu,"asidemenudefaultopened");var transformPropertyValue=_buildTransformValue(0);asideContentEle.style[_transformPropName]=asidemenu.style[_transformPropName]=transformPropertyValue;setTimeout(function(){Bk.Dom.addClass(asidemenu,"asidemenuclosed");var asidewrapper=document.getElementById("asidewrapper");asidewrapper.style.overflow="hidden";var userAgent=window.navigator.userAgent;if(Bk.Util.isAndroid("2.3")||Bk.Util.isAndroid("2.2")||Bk.Util.isAndroid("2.1")||Bk.Util.getInternetExplorerVersion()===9||Bk.Util.isOperaPresto()){_disableGlass();}else if("iOS"===Bk.Util.getOSInfo(userAgent).osName&&9<=parseFloat(Bk.Util.getOSInfo(userAgent).osVersion)){_disableGlass();}},deltatransition);document.removeEventListener('touchmove',Bk.Event.preventDefault,false);};self.onClickListener=function(e){var target=e.data.source;if(!target){return;}
if(window.innerWidth>breakpoint){return;}
if(Bk.Aside.present()){var parentNode=Bk.Dom.findParentNodeByAttr("id",ASIDE_CONTENT_ID,target);if(parentNode===document.getElementById(ASIDE_CONTENT_ID)){self.close();}}else{console.log("✘ This clickListener should not be called");}};self.resetHack=function(components){components.asideContentWrapperEle.style.marginLeft="0";components.asideContentWrapperEle.style.position="";};self.onBkChartBuild=function(e){var components=self.getComponents();if(components.error){console.log(components.error);return;}
if(window.innerWidth<=breakpoint){self.resetHack(components);}else{self.hackToKeepOutsiderElementsVisible(components);}};self.hackToKeepOutsiderElementsVisible=function(components){var contentWrapperHeight=components.asideContentWrapperEle.offsetHeight;var menuHeight=components.asidemenu.offsetHeight;console.log("contentWrapperHeight: "+contentWrapperHeight+" menuHeight: "+menuHeight);components.asideContentWrapperEle.style.position="static";components.asideContentWrapperEle.style.marginLeft="260px";};self.init=function(){var components=self.getComponents();if(components.error){return;}
if(window.innerWidth<=breakpoint){Bk.Dom.addClass(components.asidemenu,"asidemenuclosed");}else if(window.innerWidth>breakpoint){Bk.Aside.flattenMenu(components);self.hackToKeepOutsiderElementsVisible(components);}
self.registerMenuBtnClickListener();Bk.Event.addListener(Bk.Event.BK_TRANSITIONS_STARTED,document,self.onClickListener);_orientationChangeEventName=Bk.Event.onOrientationChange(self.onOrientationChange);Bk.Event.addListener(Bk.Event.BK_CHART_BUILT,document,self.onBkChartBuild);Bk.Event.addListener(Bk.Event.BK_PAGE_UNLOADED,document,self.destroy);_enableScroll();};self.destroy=function(){Bk.Event.removeListener(Bk.Event.BK_TRANSITIONS_STARTED,document,self.onClickListener);Bk.Event.removeListener(_orientationChangeEventName,window,self.onOrientationChange);Bk.Event.removeListener(Bk.Event.BK_CHART_BUILT,document,self.onBkChartBuild);document.removeEventListener('touchmove',Bk.Event.preventDefault,false);Bk.Event.removeListener(Bk.Event.BK_PAGE_UNLOADED,document,self.destroy);};(function(){Bk.Event.addListener(Bk.Event.BK_PAGE_LOADED,document,self.init);})();return self;})();Bk.navbar=(function(){"use strict";var self={};var TITLE_LIMIT=65;var BTN_RIGHT_MARGIN=14;var BTN_LEFT_MARGIN=6;(function(){Bk.onPageLoaded(function(){positionElements(Bk.Event.BK_PAGE_LOADED);});Bk.Event.onOrientationChange(function(e){positionElements(Bk.Event.BK_PAGE_LOADED);});Bk.Event.addListener(Bk.Event.BK_HEADER_LOADED,window,function(e){positionElements(Bk.Event.BK_PAGE_LOADED);});}());var positionElements=function(e){var bkHeader=Bk.Header.find();if(!bkHeader){return;}
var navBar=getNavBar(bkHeader);if(!navBar){return;}
var h1=navBar.getElementsByTagName("h1")[0];var arrowSpan=navBar.getElementsByTagName("span")[0];if(!arrowSpan){return;}
var navBarWidth=navBar.clientWidth;var a=navBar.getElementsByTagName("a")[0];clearInjectedStyle(a,h1);var arrowWidth=arrowSpan.clientWidth-11;var h1RealWidth=getRealWidth(h1);var title_maxSize=navBarWidth*TITLE_LIMIT/100;var anchorMaxLimitInPercent=window.getComputedStyle(a,null).getPropertyValue("max-width");var anchorMaxLimit=anchorMaxLimitInPercent.substr(0,anchorMaxLimitInPercent.length-1);var anchorMaxSize=navBarWidth*anchorMaxLimit/100;var buttonPaddingRightInPixel=window.getComputedStyle(a,null).getPropertyValue("padding-right");var buttonPaddingLeftInPixel=window.getComputedStyle(a,null).getPropertyValue("padding-left");var buttonPaddingRight=buttonPaddingRightInPixel.substr(0,buttonPaddingRightInPixel.length-2);var buttonPaddingLeft=buttonPaddingLeftInPixel.substr(0,buttonPaddingLeftInPixel.length-2);var totalButtonPadding=parseInt(buttonPaddingRight,10)+parseInt(buttonPaddingLeft,10);var btnContainerWidth=BTN_LEFT_MARGIN+arrowWidth+a.clientWidth+totalButtonPadding+BTN_RIGHT_MARGIN;if(h1RealWidth>title_maxSize){if(btnContainerWidth>navBarWidth-title_maxSize){h1.style.setProperty("width",title_maxSize+"px",null);var anchorWidth=navBarWidth-title_maxSize-BTN_LEFT_MARGIN-arrowWidth-totalButtonPadding-BTN_RIGHT_MARGIN;a.style.setProperty("max-width",anchorWidth+"px",null);var marginLeft=navBarWidth-title_maxSize;h1.style.setProperty("margin-left",marginLeft+"px",null);h1.style.setProperty("text-align","left",null);}else{var availableExtraFreeSpace=navBarWidth-title_maxSize-btnContainerWidth;var h1Width=title_maxSize+availableExtraFreeSpace;h1.style.setProperty("width",h1Width+"px",null);var marginLeft=btnContainerWidth;h1.style.setProperty("margin-left",marginLeft+"px",null);h1.style.setProperty("text-align","left",null);}}else if(h1RealWidth<title_maxSize&&h1RealWidth>(navBarWidth-anchorMaxSize)){var anchorWidth=navBarWidth-h1RealWidth-BTN_LEFT_MARGIN-arrowWidth-totalButtonPadding-BTN_RIGHT_MARGIN;a.style.setProperty("max-width",anchorWidth+"px",null);if(isTitleCentrable(arrowWidth,a.clientWidth,totalButtonPadding,h1RealWidth,navBarWidth)){return;}
var marginLeft=navBarWidth-h1RealWidth;if(btnContainerWidth<marginLeft){var diff=marginLeft-btnContainerWidth;if(diff>7){marginLeft=marginLeft-7;}else{marginLeft=marginLeft-(diff/2);}}else{h1.style.setProperty("padding-right",1+"px",null);}
h1.style.setProperty("margin-left",marginLeft+"px",null);h1.style.setProperty("text-align","left",null);}else{if(!isTitleCentrable(arrowWidth,a.clientWidth,totalButtonPadding,h1RealWidth,navBarWidth)){var marginLeft=BTN_LEFT_MARGIN+arrowWidth+a.clientWidth+totalButtonPadding+BTN_RIGHT_MARGIN;h1.style.setProperty("margin-left",marginLeft+"px",null);h1.style.setProperty("text-align","left",null);}}};var clearInjectedStyle=function(a,h1){var orientation=null;if(window.orientation!=='undefined'){orientation=Math.abs(window.orientation)==90?"landscape":"portrait";}
if(orientation=="landscape"||orientation=="portrait"){h1.setAttribute("style","");a.setAttribute("style","");}};var isTitleCentrable=function(arrowWidth,anchorWidth,totalButtonPadding,h1Width,navBarWidth){var res=(navBarWidth/2)>(BTN_LEFT_MARGIN+arrowWidth+anchorWidth+totalButtonPadding+BTN_RIGHT_MARGIN+(h1Width/2));return res;};var getRealWidth=function(h1){h1.style.setProperty("display","inline-block",null);var width=h1.clientWidth;h1.style.setProperty("display","block",null);return width;};var getNavBar=function(bkHeader){var divElements=bkHeader.getElementsByTagName("div");for(var i=0;i<divElements.length;i++){if(divElements[i].getAttribute("data-bk-role")=="navbar"){return divElements[i];}}
return null;};return self;}());Bk.Popup=(function(){var self={};var _node=null;var _overlay=null;var _opener=null;var _options=null;var _onOrientationChangeEventName="resize";var _init=function(id){_node=Bk.Dom.getElementById(id);_overlay=document.querySelector("div#bk-overlay");_onOrientationChangeEventName=Bk.Event.onOrientationChange(_onOrientationChangeHandler);if(_opener&&_opener.getAttribute("data-bk-options")){dataOptions=_opener.getAttribute("data-bk-options");try{_options=JSON.parse(dataOptions);}catch(e){console.error("Formatting the popup options from a String to a JSON Object failed");}}
Bk.onePageUnloaded(self.close);};var _onOrientationChangeHandler=function(){if(_node){_positionPopup();Bk.Overlay.setOverlaySize();}};var _enableClickOnChildsOrDie=function(e){e=e||window.event;var t=e.target||e.srcElement;if(Bk.Dom.findParentNodeByAttr('id',_node.getAttribute('id'),t)){Bk.Event.Delegator.clickListener(e);}else{Bk.Popup.close();Bk.Event.preventDefault(e);}
e.stopPropagation();};var _destroy=function(){Bk.Event.removeListener(_onOrientationChangeEventName,window,_onOrientationChangeHandler);if(Bk.Util.getInternetExplorerVersion()>-1){_node.removeEventListener("click",_enableClickOnChildsOrDie);_overlay.removeEventListener("click",_enableClickOnChildsOrDie);}
_node=null;_overlay=null;_opener=null;_options=null;};var _positionPopup=function(){var windowHeight=window.innerHeight;var popupHeight=_node.clientHeight;if(windowHeight>popupHeight){_node.style.top=Bk.Util.get_top_position_to_center_elment_in_body(_node)+"px";}else{_node.style.top=Bk.Util.getScrollOffset()+"px";}}
var _hidePopup=function(){if(_node){_node.style.display="none";}};var _isOpenAction=function(target){var attrName="data-bk-rel";var attrValue="popup";var result=(target.getAttribute(attrName)===attrValue)||Bk.Dom.findParentNodeByAttr(attrName,attrValue,target);if(result){_opener=target;return result;}
return false;};var _isCloseAction=function(target){if(target.nodeName.toLowerCase()==="div"&&target.getAttribute("id")==="bk-overlay"){if(_options&&_options.modal===true){return false;}
return true;}
if(target.nodeName.toLowerCase()==="a"&&target.getAttribute("data-bk-rel")==="close"){return true;}
var parent=Bk.Dom.findParentNode("a",target);if(parent&&parent.getAttribute("data-bk-rel")==="close"){return true;}
return false;};var _isOpened=function(){return _node!==null;};_handleClickEvent=function(target){if(_isCloseAction(target)){self.close();return true;}
if(_isOpenAction(target)){var id=_retrievePopupIdFromClickedTarget(target);self.open(id);return true;}
return false;};var _retrievePopupIdFromClickedTarget=function(target){var ATTRIBUTE_NAME="data-bk-rel";var ATTRIBUTE_VALUE="popup";var _target;if(target.getAttribute(ATTRIBUTE_NAME)===ATTRIBUTE_VALUE){_target=target;}else{_target=Bk.Dom.findParentNodeByAttr(ATTRIBUTE_NAME,ATTRIBUTE_VALUE,target);}
return _target.getAttribute("href").replace("#","");};self.open=function(id){if(_isOpened()){console.warn("Cannot open popup with id:"+id+", because a pop up is already opened.")
return;}
_init(id);_node.style.display="block";var body=document.getElementsByTagName("body")[0];var _show=function(){_node.style.visibility="visible";_positionPopup();Bk.Overlay.showOverlay();if(document.body.style.webkitFilter!==undefined){var wrapper=document.querySelector("div[id='"+_node.id+"'].bk-popup-wrapper");wrapper.parentNode.removeChild(wrapper);body.appendChild(wrapper);}};var chartNodes=Bk.Dom.getElementsByAttribute(_node,"div","data-bk-role","bkchart");if(chartNodes.length>0&&Bk.Capabilities.CHART_SUPPORT==='svg'){_node.style.visibility="hidden";Bk.Event.fireEvent(Bk.Event.BK_POPUP_BEFORE_OPEN,{"id":_node.id,"callback":_show});}else{Bk.Event.fireEvent(Bk.Event.BK_POPUP_BEFORE_OPEN,{"id":_node.id});_show();}
var chartNodes=Bk.Dom.getElementsByAttribute(_node,"div","data-bk-role","bkchart");if(chartNodes.length>0&&Bk.Capabilities.CHART_SUPPORT==='svg'){_node.style.visibility="hidden";Bk.Event.fireEvent(Bk.Event.BK_POPUP_BEFORE_OPEN,{"id":_node.id,"callback":_show});}else{Bk.Event.fireEvent(Bk.Event.BK_POPUP_BEFORE_OPEN,{"id":_node.id});_show();}
var carouselNodes=Bk.Dom.getElementsByAttribute(_node,"div","data-bk-role","carousel");for(var i=0;i<carouselNodes.length;i++){var args={};args.carouselId=carouselNodes[i].getAttribute("id");args.items=carouselNodes[i].getAttribute("data-bk-items");Bk.buildCarousel(args);}
if(Bk.Util.getInternetExplorerVersion()>-1){_node.removeEventListener("click",_enableClickOnChildsOrDie);_overlay.removeEventListener("click",_enableClickOnChildsOrDie);_node.addEventListener("click",_enableClickOnChildsOrDie,false);_overlay.addEventListener("click",_enableClickOnChildsOrDie,false);}};self.close=function(){if(_isOpened()){Bk.Event.fireEvent(Bk.Event.BK_POPUP_ON_CLOSE,{"id":_node.id});Bk.Overlay.hideOverlay();_hidePopup();_destroy();var wrappers=document.querySelectorAll(".bk-popup-wrapper");var body=document.getElementById("bk-body");for(var i=0;i<wrappers.length;i++){var w=wrappers[i];body.appendChild(w);}}};self.getOpened=function(){var popupList=self.list();for(var i=0;i<popupList.length;i++){style=window.getComputedStyle(popupList[i],null);if(style.display!=="none"){return popupList[i].getAttribute("id");}}
return null;};self.list=function(){return document.querySelectorAll("[data-bk-role=popup]");};(function(){Bk.onePageLoaded(function(){Bk.Event.Delegator.registerEventHandler(_handleClickEvent);});}());return self;}());Bk.Util=(function(){var self={};self.isNull=function(elt){return elt==null||typeof(elt)==='undefined';};self.isWindow=function(obj){return obj&&typeof obj==="object"&&"setInterval"in obj;};self.getWindow=function(elem){return Bk.Util.isWindow(elem)?elem:elem.nodeType===9?elem.defaultView||elem.parentWindow:false;};self.getClassName=function(obj){if(obj&&obj.constructor&&obj.constructor.toString){var arr=obj.constructor.toString().match(/function\s*(\w+)/);if(arr&&arr.length==2){return arr[1];}}
return undefined;};self.isArray=function(obj){if(self.isNull(obj)){return false}
return(obj.constructor.toString().indexOf("Array")!==-1);};self.getScreenHeight=function(){if(typeof(window.innerHeight)==='number'){return window.innerHeight;}else{return self.getBodyHeight();}};self.getBodyHeight=function(){if(document.documentElement&&(document.documentElement.clientHeight)){return document.documentElement.clientHeight;}};self.get_top_position_to_center_elment_in_body=function(node){var topPos=((self.getBodyHeight()-node.clientHeight)/2);return topPos+self.getScrollOffset();};self.hideURLBarCallback=function(){var lastIndexOfHash=window.location.href.lastIndexOf("#");lastIndexOfHash>-1?lastFragment=window.location.href.split(lastIndexOfHash):lastFragment=undefined;if(!lastFragment){window.requestAnimationFrame(function(){var insignificantScrollUp=function(){window.scrollBy(0,1);};var insignificantScrollDown=function(){window.scrollBy(0,-1);};insignificantScrollUp();setTimeout(insignificantScrollDown,0);});}
window.removeEventListener(Bk.Event.BK_PAGE_LOADED,self.hideURLBarCallback,false);};self.hideURLBar=function(){window.addEventListener(Bk.Event.BK_PAGE_LOADED,self.hideURLBarCallback,false);};self.getCookie=function(name){var nameEQ=name+"=";var ca=document.cookie.split(';');for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==' ')c=c.substring(1,c.length);if(c.indexOf(nameEQ)==0)return c.substring(nameEQ.length,c.length);}
return null;};self.setCookie=function(name,value,days){if(days){var date=new Date();date.setTime(date.getTime()+(days*24*60*60*1000));var expires="; expires="+date.toGMTString();}else{var expires="";}
document.cookie=name+"="+value+expires+"; path=/";};self.eraseCookie=function(name){self.setCookie(name,"",-1);};self.scrollTo=function(eltId){var elt=document.getElementById(eltId);if(elt){window.scrollTo(0,Bk.offset(elt).top);}else{console.warn("We cannot scroll, element with id: "+eltId+" does not exist.");}};self.isEmpty=function(chain){if(!chain){return true;}
return chain.replace(/^\s+|\s+$/,'').length==0;};self.createUUID=function(){var s=[];var hexDigits="0123456789ABCDEF";for(var i=0;i<32;i++){s[i]=hexDigits.substr(Math.floor(Math.random()*0x10),1);}
s[12]="4";s[16]=hexDigits.substr((s[16]&0x3)|0x8,1);return s.join("");};self.computeLeftPosition=function(node){var result=(window.innerWidth-node.clientWidth)/2;return result;};self.getDocumentHeight=function(){return Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight,document.documentElement.clientHeight);};self.getScrollOffset=function(){var scrollOffset=0;if(document.documentElement&&(document.documentElement.scrollTop)){scrollOffset=document.documentElement.scrollTop;}else if(window.pageYOffset){scrollOffset=window.pageYOffset;}
return scrollOffset;};self.parseJSON=function(data){var rvalidchars=/^[\],:{}\s]*$/;var rvalidbraces=/(?:^|:|,)(?:\s*\[)+/g;var rvalidescape=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g;var rvalidtokens=/"[^"\\\r\n]*"|true|false|null|-?(?:\d\d*\.|)\d+(?:[eE][\-+]?\d+|)/g;if(!data||typeof data!=="string"){return null;}
if(window.JSON&&window.JSON.parse){return window.JSON.parse(data);}
if(rvalidchars.test(data.replace(rvalidescape,"@").replace(rvalidtokens,"]").replace(rvalidbraces,""))){return(new Function("return "+data))();}};self.isFirefox=function(){return navigator.userAgent.toLowerCase().indexOf('firefox')>-1;};self.isAndroid=function(expectedVersion){var pattern=/Android\s+([\d\.]+)/;var matcher=pattern.exec(navigator.userAgent);if(matcher&&matcher.length===2){var actualVersion=matcher[1];if(actualVersion.lastIndexOf(expectedVersion,0)===0){return true;}}
return false;};self.isAndroidStock=function(){var nua=navigator.userAgent;var is_android=((nua.indexOf('Mozilla/5.0')>-1&&nua.indexOf('Android ')>-1&&nua.indexOf('AppleWebKit')>-1)&&!(nua.indexOf('Chrome')>-1));return is_android;};self.getInternetExplorerVersion=function(){var rv=-1;var ua=navigator.userAgent;if(navigator.appName=='Microsoft Internet Explorer'){var re=new RegExp("MSIE ([0-9]{1,}[\.0-9]{0,})");if(re.exec(ua)!=null)
rv=parseFloat(RegExp.$1);}
else if(navigator.appName=='Netscape')
{var re=new RegExp("Trident/.*rv:([0-9]{1,}[\.0-9]{0,})");if(re.exec(ua)!=null)
rv=parseFloat(RegExp.$1);}
return rv;};self.isOperaPresto=function(){return window.opera;};self.getOSInfo=function(){var info={"osName":'unknown',"osVersion":'unknown'};var ua=navigator.userAgent;var uaindex;if(ua.match(/iPad/i)||ua.match(/iPhone/i)){info.osName='iOS';uaindex=ua.indexOf('OS ');}else if(ua.match(/Android/i)){info.osName='Android';uaindex=ua.indexOf('Android ');}
if(info.osName==='iOS'&&uaindex>-1){info.osVersion=ua.substr(uaindex+3,3).replace('_','.');}else if(info.osName==='Android'&&uaindex>-1){info.osVersion=ua.substr(uaindex+8,3);}
return info;}
self.isNumber=function(n){return!isNaN(parseFloat(n))&&isFinite(n);};self.noop=function(){};self.forceRepaint=function(timeout,element){var elem=element||document.documentElement;var emptyTextNode=document.createTextNode(' ');elem.appendChild(emptyTextNode);if(timeout){setTimeout(function(){elem.removeChild(emptyTextNode);},timeout);}else{elem.removeChild(emptyTextNode);}};self.getWidth=function(currentNode){var width=0;width=Math.ceil((("getBoundingClientRect"in currentNode)?currentNode.getBoundingClientRect().width:currentNode.offsetWidth));if(width===0&&typeof window.getComputedStyle==='function'){width=parseInt(window.getComputedStyle(currentNode,null).width);}
else if(width===0&&typeof window.getComputedStyle!=='function'){if(currentNode.style.width!==''){width=parseInt(currentNode.style.width);}}
return width;};self.getParentWidth=function(currentNode){var width=0;while(!width||width==="auto"){currentNode=currentNode.parentNode;if(!currentNode||currentNode===document){width=document.width;break;}
width=Bk.Util.getWidth(currentNode);}
return width;};self.adjustFixedHeaderAndFooterPosition=(function(){var This={};var _headerIsConcerned=_footerIsConcerned=false;var _pageYOffset=_pageXOffset=0;This.isTrigger=function(element){var nodeName=element.nodeName.toLocaleLowerCase();if("input"===nodeName){var keyboardInputs=["text","number","tel","email","password","file","date","datetime-local","month","time","week","url","search"];if(keyboardInputs.indexOf(element.type)>-1){return true;}}
else if(["textarea","select"].indexOf(nodeName)>-1){return true;}
return false;};This.behaviour=function(event){var element=event.target||event.srcElement;if(!This.isTrigger(element)){return false;}
_pageYOffset=window.pageYOffset;_pageXOffset=window.pageXOffset;if("focus"===event.type){if(Bk.Header.isFixed()){_headerIsConcerned=true;Bk.Header.unfixed();}
if(Bk.Footer.isFixed()){_footerIsConcerned=true;Bk.Footer.unfixed();}}
else if("blur"===event.type){if(_headerIsConcerned){Bk.Header.fixed();}
if(_footerIsConcerned){Bk.Footer.fixed();}}
window.scrollTo(_pageXOffset,_pageYOffset);};This.setListeners=function(){if(Bk.Header.isFixed()||Bk.Footer.isFixed()){document.addEventListener("focus",This.behaviour,true);document.addEventListener("blur",This.behaviour,true);}};This.unsetListeners=function(){document.removeEventListener("focus",This.behaviour);document.removeEventListener("blur",This.behaviour);};This.launch=function(){var osInfos=self.getOSInfo();if(osInfos.osName&&["iOS","Android"].indexOf(osInfos.osName)>-1){window.addEventListener("bkPageLoaded",This.setListeners,false);window.addEventListener("bkPageUnloaded",This.unsetListeners,false);}};This.launch();return This;})();self.isChildOf=function(child,parent){if(!(child&&parent)){return false;}
while((child=child.parentNode)&&child!==parent){};return!!child;};self.getElementOffset=function(elem){if(!elem){return;}
var box={top:0,left:0};if(!self.isChildOf(elem,document.documentElement)){return box;}
if(elem.getBoundingClientRect){box=elem.getBoundingClientRect();}
return{top:box.top+self.getScrollOffset()-(document.documentElement.clientTop||0),left:box.left+self.getScrollOffset()-(document.documentElement.clientLeft||0)};};self.getElementPosition=function(elem){if(!elem){return;}
var offsetParent;var offset;var parentOffset={top:0,left:0};var computedStyle=document.defaultView.getComputedStyle(elem,null);var _offsetParent=function(elem){var offsetParent=elem.offsetParent||document.documentElement;while(offsetParent&&"html"===offsetParent.nodeName.toLowerCase()){var offsetParentStyles=document.defaultView.getComputedStyle(offsetParent,null);if("static"===offsetParentStyles.position){offsetParent=offsetParent.offsetParent;continue;}
break;}
return offsetParent||document.documentElement;};if(elem.style.position==="fixed"){offset=elem.getBoundingClientRect();}else{offsetParent=_offsetParent(elem);offset=self.getElementOffset(elem);if(!("html"===offsetParent.nodeName.toLowerCase())){parentOffset=self.getElementOffset(offsetParent);}
var offsetParentStyles=document.defaultView.getComputedStyle(offsetParent,null);parentOffset.top+=parseFloat(offsetParentStyles.borderTopWidth.replace("px",""));parentOffset.left+=parseFloat(offsetParentStyles.borderLeftWidth.replace("px",""));}
var elemStyles=document.defaultView.getComputedStyle(elem,null);return{top:offset.top-parentOffset.top-parseFloat(elemStyles.marginTop.replace("px","")),left:offset.left-parentOffset.left-parseFloat(elemStyles.marginLeft.replace("px",""))};};return self;}());Bk.Dom=(function(){var self={};self.insertAfter=function(newElement,targetElement){var parent=targetElement.parentNode;if(parent.lastchild==targetElement){parent.appendChild(newElement);}else{parent.insertBefore(newElement,targetElement.nextSibling);}};self.importContainer=function(container,id){var container=Bk.Dom.getElementById(id,container);if(container){container=Bk.Dom.importNode(container,true);}
return container;};self.findParentNode=function(parentName,node){var node=node.parentNode;while(node&&(node.nodeName.toLowerCase()!==parentName.toLowerCase())){node=node.parentNode;}
return node;};self.findParentNodeByAttr=function(attrName,attrValue,noude){var node=noude.parentNode;var found=false;while(node&&!found){if(node.getAttribute&&(node.getAttribute(attrName)===attrValue)){found=true;}else{node=node.parentNode;}}
if(found){return node;}
return null;};self.importNode=function(node,deep){if(window.ActiveXObject){return document._importNode(node,deep);}else{return document.importNode(node,deep);}};self.getElementById=function(id,element){var currentEle;if(element==='undefined'||element==null){currentEle=window.document;}else{currentEle=element;}
if(typeof currentEle.getElementById!='function'){var elms=currentEle.getElementsByTagName('*');for(var i=0;i<elms.length;i++){if(elms[i].getAttribute('id')){if(elms[i].getAttribute('id')==id)
return elms[i];}else if(elms[i].id){if(elms[i].id==id){return elms[i];}}}
return null;}else{return currentEle.getElementById(id);}};self.getAllById=function(id,doc){doc=doc||document;if(doc.querySelectorAll){return doc.querySelectorAll("#"+id);}else{console.error("document.querySelectorAll not available. Polyfill needed.");return[doc.getElementById(id)];}};self.getElementsByAttribute=function(rootElement,strTagName,strAttributeName,strAttributeValue){var arrElements=rootElement.getElementsByTagName(strTagName);var arrReturnElements=new Array();var oAttributeValue=(typeof strAttributeValue!="undefined")?new RegExp("(^|\\s)"+strAttributeValue
+"(\\s|$)","i"):null;var oCurrent;var oAttribute;for(var i=0;i<arrElements.length;i++){oCurrent=arrElements[i];oAttribute=oCurrent.getAttribute&&oCurrent.getAttribute(strAttributeName);if(typeof oAttribute=="string"&&oAttribute.length>0){if(typeof strAttributeValue=="undefined"||(oAttributeValue&&oAttributeValue.test(oAttribute))){arrReturnElements.push(oCurrent);}}}
return arrReturnElements;};self.getChildElementById=function(parent,id){var nodeIterator=document.createNodeIterator(parent,NodeFilter.SHOW_ELEMENT,function(node){if(node.getAttribute("id")===id){return NodeFilter.FILTER_ACCEPT;}
return NodeFilter.FILTER_SKIP;},false);return nodeIterator.nextNode();};self.getInnerText=function(el){var that=this;if(typeof el==='string'||typeof el==='undefined')return el;if(el.innerText)return el.innerText;var str='';var cs=el.childNodes;var l=cs.length;for(var i=0;i<l;i++){switch(cs[i].nodeType){case 1:str+=that.getInnerText(cs[i]);break;case 3:str+=cs[i].nodeValue;break;}}
return str;};self.rgClass=/[\n\t]/g;self.rgSpace=/\s+/;self.addClass=function(elt,clazz){var classNames=(clazz||"").split(self.rgSpace);if(!elt.className){elt.className=clazz;}else{var className=" "+elt.className+" ";for(var c=0,cl=classNames.length;c<cl;c++){if(className.indexOf(" "+classNames[c]+" ")<0){elt.className+=" "+classNames[c];}}}};self.hasClass=function(elt,clazz){var className=" "+clazz+" ";return(" "+elt.className+" ").replace(self.rgClass," ").indexOf(className)>-1;};self.isClassEmpty=function(elt){if(Bk.Util.isNull(elt)){return true;}
return""==elt.className.replace(" ","","gi");};self.dataFromClass=function(elt,prefix){var classNames=elt.className.split(self.rgSpace);var data;for(var c=0,cl=classNames.length;c<cl&&!data;c++){var idx=classNames[c].indexOf(prefix);if(-1<idx){data=classNames[c].substr(idx+prefix.length);}}
return data;};self.removeClass=function(elt,clazz){var classNames=(clazz||"").split(self.rgSpace);if(clazz){var className=(" "+elt.className+" ").replace(self.rgSpace," ");for(var c=0,cl=classNames.length;c<cl;c++){className=className.replace(" "+classNames[c]+" "," ");}
elt.className=className.substring(1,className.length-1);}else{elt.className="";}};self.toggleClass=function(elt,clazz){self.hasClass(elt,clazz)?self.removeClass(elt,clazz):self.addClass(elt,clazz);};self.isStyleEmpty=function(elt){if(Bk.Util.isNull(elt)){return true;}
return elt.style.length==0;};self.remove_attr_if_empty=function(attr,elt){if(!elt.getAttribute(attr)||elt.getAttribute(attr).trim().length===0){elt.removeAttribute(attr);}};self.getContent=function(node){return(node.text||node.textContent||node.innerHTML);};self.showInPage=function(box){box.style.display="block";};self.hideInPage=function(box){box.style.display="none";};self.setNewId=function(elt){var newId=Bk.Util.createUUID();elt.setAttribute("id",newId);return newId;};self.nodeName=function(elt,name){return elt.nodeName.toUpperCase()===name.toUpperCase();};self.removeNode=function(node){if(node&&node.parentNode){node.parentNode.removeChild(node);}};self.removeChildrenFromNode=function(node){if(!node){return false;}
while(node.hasChildNodes()){node.removeChild(node.lastChild);}
return true;};return self;})();Bk.Capabilities=(function(){"use strict";var self={};self.SCREEN_WIDTH=320;self.CHART_SUPPORT='svg';return self;}());Bk.isHistoryEmpty=function(){return Bk.History.isEmpty();};Bk.initContext=function(){Bk.History.initContext();};Bk.releaseContext=function(){Bk.History.releaseContext();};Bk.swap=function(args){var transition=new SwapTransition(args);transition.process();};Bk.toggle=function(args){var transition=new ToggleTransition(args);transition.process();};Bk.replace=function(args){Bk.replaceSection(args);};Bk.submit=function(args,submit){Bk.submitSection(args,submit);};Bk.replaceSection=function(args){var transition=new ReplaceSectionTransition(args);transition.process();};Bk.submitSection=function(args,submit){var transition=new SubmitSectionTransition(args,submit);transition.process();};Bk.replacePage=function(args){var transition=new ReplacePageTransition(args);transition.process();};Bk.submitPage=function(args){var transition=new SubmitPageTransition(args);transition.process();};Bk.Debug=(function(){"use strict";var self={};var enabled=false;var _displayAjaxFailureMessage=function(args){if(!Bk.Debug.isEnabled()){return;}
var header=Bk.Dom.getElementById("bk-header");var body=Bk.Dom.getElementById("bk-body");var parent=(header)?header:body;var id="bk-ajax-failure";var message=Bk.Dom.getElementById(id);if(message==null){message=document.createElement("div");message.id=id;}
message.innerHTML=args.message+" ";message.setAttribute("style","background-color:#b5c900;color:white;padding:2px;font-size:14px;");if(args.xhr&&args.xhr.status!=0){var link=document.createElement("a");link.innerHTML="<br/>See error details.";link.setAttribute("href","javascript:;");link.setAttribute("style","color:white;");message.appendChild(link);var openDeveloperErrorPage=function(){var w=window.open();w.document.write(args.xhr.responseText);w.focus();}
link.addEventListener("click",openDeveloperErrorPage,false);}
parent.insertBefore(message,parent.firstChild);Bk.onePageUnloaded(function(){parent.removeChild(message);});};self.isEnabled=function(){return enabled;};self.handleError=function(message){_displayAjaxFailureMessage({message:"<b>WOPE debug</b><br/>"+message});console.warn(message);};self.handleNotXMLResponseError=function(args){var mime=args.xhr.getResponseHeader("Content-Type");var message="wope expected to receive an XML response from target application (currently: "+mime+")";_displayAjaxFailureMessage({message:"<b>WOPE debug</b><br/>"+message});console.warn(message);};self.handleServerError=function(args){var message="server error while fetching url "+args.url+" (status code: "+args.xhr.status+")";if(args.xhr.status===0){message+=". HTTP status code is not available, either the remote server did not respond or its url has not been whitelisted.";}
_displayAjaxFailureMessage({message:"<b>WOPE debug</b><br/>"+message,xhr:args.xhr});console.warn(message);};self.handleServerTimeout=function(args){var message="a timeout error while fetching url "+args.url+". Target application took more than "
+Bk.Ajax.getTimeOut()+" milliseconds to respond"
_displayAjaxFailureMessage({message:"<b>WOPE debug:</b><br/>"+message});console.warn(message);};return self;}());Bk.Ajax=(function(){"use strict";var self={};self.POST="POST";self.GET="GET";var current=null;var timeout=10000;var create=function(){var xhr;try{xhr=new XMLHttpRequest();}catch(e){try{xhr=new ActiveXObject("Msxml2.XMLHTTP");}
catch(e2){try{xhr=new ActiveXObject("Microsoft.XMLHTTP");}
catch(e){}}}
return xhr;};self.setTimeOut=function(_timeout){timeout=_timeout;};self.getTimeOut=function(){return timeout;};self.isSuccess=function(xhr){return 200==xhr.status;};self.fetch=function(args){var timer;var async=true;var inTimeout=false;var xhr=create();if(timeout>0){timer=setTimeout(function(){inTimeout=true;xhr.abort();args.onTimeout();Bk.Event.fireEvent(Bk.Event.BK_PAGE_LOAD_REQUEST_TIMEOUT,{"xhr":xhr});},timeout);}
xhr.onreadystatechange=function(){if(xhr.readyState<4){return;}
if(xhr.readyState==4){xhr.onreadystatechange=function(){};current=undefined;if(timer){clearTimeout(timer);}
if(self.isSuccess(xhr)){if(args.checkResponse===true){var str=xhr.responseText;var isblank=(!str||/^\s*$/.test(str));if(!isblank){str=xhr.responseXML;if(window.ActiveXObject&&xhr.responseXML.xml){str=xhr.responseXML.xml;}
isblank=(!str||/^\s*$/.test(str));}
if(isblank){console.warn("empty ajax response received");Bk.Event.fireBkAjaxError(xhr);args.onError(xhr);}else{if(self.isResponseContentTypeAllowed(xhr)){Bk.Event.fireBkAjaxSuccess(xhr);args.onSuccess(xhr);}else{Bk.Event.fireBkAjaxError(xhr);args.onError(xhr);}}}else{Bk.Event.fireBkAjaxSuccess(xhr);args.onSuccess(xhr);}}else{if(!inTimeout){Bk.Event.fireBkAjaxError(xhr);var isCustomizedErrorPage=function(){return(xhr.responseXML!==null)&&(xhr.responseXML.getElementById("bk-body")!==null);}
if(!Bk.Debug.isEnabled()&&isCustomizedErrorPage()){args.onCustomError(xhr);}else{args.onError(xhr);}}}}}
var sessionidRegex=new RegExp(";jsessionid=\\w+[^\\?]+","i");var url=args.url.replace(sessionidRegex,"");var method=args.method;var data=null;if(args.data){data=args.data.join("&").replace(/%20/g,"+");if(method.toUpperCase()===self.GET){url+=(url.indexOf("?")>-1?"&":"?")+data;data=null;}}
if(args.back&&method.toUpperCase()===self.POST){method=self.GET;data=null;}
if(method==null){method=self.GET;}
if((url.indexOf("?")==-1)&&!(method&&method.toLowerCase()==='post')){if(args.location){url+=args.location.search;}}
xhr.open(method,url,async);xhr.setRequestHeader("X-Bk-Ajax","application/xml");if(data){xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8");}
if(args.beforeSend){args.beforeSend(xhr);}
if(xhr.overrideMimeType){xhr.overrideMimeType('application/xml');}
xhr.send(data);current=xhr;};self.isResponseContentTypeAllowed=function(xhr){var ctype=xhr.getResponseHeader("Content-type");return ctype&&(ctype.indexOf("text/html")==0||ctype.indexOf("application/xml")==0);};self.recoverBodyAttributes=function(xhr,xml){try{var body=xml.documentElement.getElementsByTagName("body")[0];var responseText=xhr.responseText;var bodyStr=responseText.substr(responseText.indexOf('<body'));bodyStr=bodyStr.substr(0,bodyStr.indexOf('>')+1);bodyStr+="</body>";var parser=new DOMParser();var bodyDoc=parser.parseFromString(bodyStr,"text/xml");var bodyAttributes=bodyDoc.documentElement.attributes;for(var i=0;i<bodyAttributes.length;i++){if(bodyAttributes.item(i).value){body.setAttribute(bodyAttributes.item(i).name,bodyAttributes.item(i).value);}}}
catch(err){console.log("recovering the body attributes has failed");}
return xml;};self.getXMLResponse=function(xhr){var xml;if(window.ActiveXObject&&!(navigator.userAgent.indexOf("MSIE 10")>0)){xml=new ActiveXObject('Microsoft.XMLDOM');xml.async=false;var origin=xhr.responseText;origin=origin.replace('<?xml version="1.0" encoding="UTF-8"?>','');origin=origin.replace('<!DOCTYPE html','');origin=origin.replace('SYSTEM "about:legacy-compat">','');xml.loadXML(origin);}else{xml=xhr.responseXML;}
if(xml===null){console.error("Error while trying to retrieve XML document from response body: \n\n"+xhr.responseText);}
if(Bk.Util.getInternetExplorerVersion()>-1){xml=self.recoverBodyAttributes(xhr,xml);}
return xml;};return self;}());Bk.Geolocation=(function(){"use strict";var self={};self.init=function(){var precision=getGeolocPrecision();getLocation(precision,populateInputFieldsWithCurrentPosition,populateInputFieldsWithPositionError);};self.getCurrentPosition=function(precision,onLocationSuccess,onLocationFailure){getLocation(precision,onLocationSuccess,onLocationFailure);};var getLocation=function(precision,onLocationSuccess,onLocationFailure){if(window.navigator.geolocation){var geoloc=window.navigator.geolocation;if(precision!='undefined'&&precision=='accurate'){geoloc.getCurrentPosition(onLocationSuccess,onLocationFailure,{enableHighAccuracy:true});}else if(precision!='undefined'&&precision=='fast'){geoloc.getCurrentPosition(onLocationSuccess,onLocationFailure);}}else{console.warn("Geolocation not supported");}};var getGeolocPrecision=function(){var inputs=document.getElementsByTagName("input");var precision;for(var i=0;i<inputs.length;i++){if(inputs[i].getAttribute&&inputs[i].getAttribute("data-bk-geolocation")){precision=inputs[i].getAttribute("data-bk-geolocation");break;}}
return precision;};var setGeolocInputFieldValue=function(pos){if(getGeolocPrecision()!='undefined'){var inputs=document.getElementsByTagName("input");for(var i=0;i<inputs.length;i++){if(inputs[i].getAttribute&&inputs[i].getAttribute("data-bk-geolocation")){inputs[i].value=pos;}}}};var populateInputFieldsWithCurrentPosition=function(position){var pos=position.coords.latitude+",";pos+=position.coords.longitude;setGeolocInputFieldValue(pos);};var populateInputFieldsWithPositionError=function(error){switch(error.code){case error.TIMEOUT:setGeolocInputFieldValue('ERROR:TIMEOUT');break;case error.PERMISSION_DENIED:setGeolocInputFieldValue('ERROR:PERMISSION_DENIED');break;case error.POSITION_UNAVAILABLE:setGeolocInputFieldValue('ERROR:POSITION_UNAVAILABLE');break;case error.UNKNOWN_ERROR:setGeolocInputFieldValue('ERROR:UNKNOWN_ERROR');break;}};return self;}());Bk.animation={KEEP_NODE:"data-bk-keep-node",nodes:[],impl:function(name){var animationFn=Bk.animation.doNone;if(name==="slide"){animationFn=Bk.animation.doSlide;}else if(name==="slide-backwards"){animationFn=Bk.animation.doSlideBackwards;}else if(name==="flip"){animationFn=Bk.animation.doFlip;}else if(name==="flip-backwards"){animationFn=Bk.animation.doFlipBackwards;}else if(name==="fade"){animationFn=Bk.animation.doFade;}else if(name==="unfold"){animationFn=Bk.animation.doUnfold;}
return animationFn;},reverse:function(name){var reverse="";if(name==="slide"){reverse="slide-backwards";}else if(name==="slide-backwards"){reverse="slide";}else if(name==="flip"){reverse="flip-backwards";}else if(name==="flip-backwards"){reverse="flip";}else if(name==="fade"){reverse="fade";}else if(name==="unfold"){reverse="unfold";}
return reverse;},doNone:function(oldBox,newBox,isTransitionInplace,isRemoteCall,oldBoxTransitionEnd){Bk.animation.status.start({from:oldBox.id,to:newBox.id,transition:'none',isRemoteCall:isRemoteCall,nbOfCompletedCallRemaining:1});if(isTransitionInplace){Bk.Dom.hideInPage(oldBox);}else{oldBox.parentNode.insertBefore(newBox,oldBox.nextSibling);oldBoxTransitionEnd({target:oldBox});if(isRemoteCall&&newBox.id=="bk-body"){Bk.Event.fireBkBodyLoaded(newBox);}}
Bk.animation.status.complete({from:oldBox.id,to:newBox.id,transition:'none'});},doSlide:function(oldBox,newBox,isTransitionInplace,isRemoteCall,oldBoxTransitionEnd){Bk.animation.slide(oldBox,newBox,false,isTransitionInplace,isRemoteCall,oldBoxTransitionEnd);},doSlideBackwards:function(oldBox,newBox,isTransitionInplace,isRemoteCall,oldBoxTransitionEnd){Bk.animation.slide(oldBox,newBox,true,isTransitionInplace,isRemoteCall,oldBoxTransitionEnd);},doFlip:function(oldBox,newBox,isTransitionInplace,isRemoteCall,oldBoxTransitionEnd){Bk.animation.flip(oldBox,newBox,false,isTransitionInplace,isRemoteCall,oldBoxTransitionEnd);},doFlipBackwards:function(oldBox,newBox,isTransitionInplace,isRemoteCall,oldBoxTransitionEnd){Bk.animation.flip(oldBox,newBox,true,isTransitionInplace,isRemoteCall,oldBoxTransitionEnd);},doFade:function(oldBox,newBox,isTransitionInplace,isRemoteCall,oldBoxTransitionEnd){Bk.animation.fade(oldBox,newBox,isTransitionInplace,isRemoteCall,oldBoxTransitionEnd);},doUnfold:function(oldBox,newBox,isTransitionInplace,isRemoteCall,oldBoxTransitionEnd){Bk.animation.unfold(oldBox,newBox,isTransitionInplace,isRemoteCall,oldBoxTransitionEnd);},removeBoxCallback:function(evt){var box=evt.target;if(box.getAttribute(Bk.animation.KEEP_NODE)===null){if(box.parentNode){box.parentNode.removeChild(box);}}
box.removeAttribute(Bk.animation.KEEP_NODE);},hideBoxCallback:function(evt){Bk.Dom.hideInPage(evt.target);},slide:function(oldBox,newBox,ltr,isTransitionInplace,isRemoteCall,oldBoxTransitionEnd){var transitionendEventName=window.Wopernizr.whichTransitionEvent();window.Wopernizr.detect("transform")?transformProp="transform":transformProp="-webkit-transform";Bk.animation.registerNodeInTransition(transitionendEventName,oldBox,newBox);if(!oldBox.parentNode){console.warn("No parent node, abort slide transition");return;}
var transition=ltr?"slide-backwards":"slide";var slideWidth=oldBox.clientWidth;newBox[transformProp]="translateX("+(ltr?-slideWidth:slideWidth)+"px)";Bk.Dom.addClass(oldBox,"bk-slide");Bk.Dom.addClass(newBox,"bk-slide");var _newBox=newBox.cloneNode(true);if(newBox.parentNode){newBox.parentNode.removeChild(newBox);}
oldBox.parentNode.insertBefore(_newBox,oldBox.nextSibling);if(isRemoteCall&&_newBox.id=="bk-body"){Bk.Event.fireBkBodyLoaded(_newBox);}
Bk.animation.makeBoxAbsolute(oldBox,_newBox,transitionendEventName);var _startTransition=function(aOldBoxStyle,aNewBoxStyle,aSlideWidth){Bk.animation.status.start({from:oldBox.id,to:_newBox.id,transition:transition,isRemoteCall:isRemoteCall,nbOfCompletedCallRemaining:2});var oldBoxWebkitTransformNewValue="translateX("+aSlideWidth+"px)";var newBoxWebkitTransformNewValue="translateX(0)";if(aOldBoxStyle[transformProp]===oldBoxWebkitTransformNewValue){var msg='bk-slide class has a transition-property -webkit-transform \n'+'and the new value of the -webkit-transform is the same as the old one\n'+'which means you will not receive a webkitTransitionEnd/transitionEnd event for oldBox \n';console.warn(msg);}
if(aNewBoxStyle[transformProp]===newBoxWebkitTransformNewValue){var msg='bk-slide class has a transition-property -webkit-transform\n'+'and the new value of the -webkit-transform is the same as the old one\n'+'which means you will not receive a webkitTransitionEnd/transitionEnd event for newBox \n';console.warn(msg);}
aOldBoxStyle[transformProp]=oldBoxWebkitTransformNewValue;aNewBoxStyle[transformProp]=newBoxWebkitTransformNewValue;};var _bothBoxesTransitionEndCallBack=function(evt){var box=evt.target;Bk.Dom.removeClass(box,"bk-slide");box.style[transformProp]="";Bk.Dom.remove_attr_if_empty("class",box);Bk.Dom.remove_attr_if_empty("style",box);Bk.animation.status.complete({from:oldBox.id,to:_newBox.id,transition:transition});};var _oldBoxtransitionEndCallback=function(evt){var oldBox=evt.target;oldBox.removeEventListener(evt.type,arguments.callee,false);oldBoxTransitionEnd(evt);};Bk.bindOnce(transitionendEventName,oldBox,_oldBoxtransitionEndCallback);Bk.bindOnce(transitionendEventName,oldBox,_bothBoxesTransitionEndCallBack);Bk.bindOnce(transitionendEventName,_newBox,_bothBoxesTransitionEndCallBack);_startTransition(oldBox.style,_newBox.style,(ltr?slideWidth:-slideWidth));Bk.animation.listenToCreateLocationTimer(transitionendEventName,_newBox);},fade:function(oldBox,newBox,isTransitionInplace,isRemoteCall,oldBoxTransitionEnd){var transitionendEventName=window.Wopernizr.whichTransitionEvent();var _startTransition=function(aOldBox,aNewBox){Bk.animation.status.start({from:oldBox.id,to:newBox.id,transition:'fade',isRemoteCall:isRemoteCall,nbOfCompletedCallRemaining:2});var oldBoxOpacityNewValue=0;var newBoxOpacityNewValue=1;if(aOldBox.style.opacity===oldBoxOpacityNewValue){var msg='bk-fade class has a transition-property opacity\n'+'and the new value of the opacity is the same as the old one\n'+'which means you will not receive a webkitTransitionEnd event for oldBox \n';console.warn(msg);}
if(aNewBox.style.opacity===newBoxOpacityNewValue){var msg='bk-fade class has a transition-property opacity\n'+'and the new value of the opacity is the same as the old one\n'+'which means you will not receive a webkitTransitionEnd event for newBox \n';console.warn(msg);}
aOldBox.style.opacity=oldBoxOpacityNewValue;aNewBox.style.opacity=newBoxOpacityNewValue;};var _onBothBoxesTransitionEnd=function(evt){var box=evt.target;Bk.Dom.removeClass(box,"bk-fade");box.style.opacity="";Bk.Dom.remove_attr_if_empty("class",box);Bk.Dom.remove_attr_if_empty("style",box);Bk.animation.status.complete({from:oldBox.id,to:newBox.id,transition:'fade'});};Bk.animation.registerNodeInTransition(transitionendEventName,oldBox,newBox);if(!oldBox.parentNode){console.info("No parent node, abort fade transition");return;}
newBox.style.opacity="0";newBox.style.display="block";Bk.Dom.addClass(oldBox,"bk-fade");Bk.Dom.addClass(newBox,"bk-fade");oldBox.parentNode.insertBefore(newBox,oldBox.nextSibling);if(isRemoteCall&&newBox.id=="bk-body"){Bk.Event.fireBkBodyLoaded(newBox);}else{Bk.Event.fireEvent(Bk.Event.BK_NODE_LOADED,{"node":newBox});}
Bk.bindOnce(transitionendEventName,oldBox,oldBoxTransitionEnd);Bk.bindOnce(transitionendEventName,oldBox,_onBothBoxesTransitionEnd);Bk.bindOnce(transitionendEventName,newBox,_onBothBoxesTransitionEnd);Bk.animation.makeBoxAbsolute(oldBox,newBox,transitionendEventName);_startTransition(oldBox,newBox);Bk.animation.listenToCreateLocationTimer(transitionendEventName,newBox);},unfold:function(oldBox,newBox,isTransitionInplace,isRemoteCall,oldBoxTransitionEnd){var transitionendEventName=window.Wopernizr.whichTransitionEvent();Bk.animation.registerNodeInTransition(transitionendEventName,oldBox,newBox);if(!oldBox.parentNode){console.warn("No parent node, abort unfold transition");return;}
var newBoxStyle=newBox.style;var oldHeight=parseInt(getComputedStyle(oldBox,null).height,10);newBoxStyle.position="absolute";newBoxStyle.top="0";newBoxStyle.visibility="hidden";oldBox.parentNode.insertBefore(newBox,oldBox.nextSibling);if(isRemoteCall&&newBox.id=="bk-body"){Bk.Event.fireBkBodyLoaded();}
var newHeight=parseInt(getComputedStyle(newBox,null).height,10);oldBox.parentNode.removeChild(newBox);newBoxStyle.position="";newBoxStyle.top="";newBoxStyle.visibility="";newBoxStyle.height=oldHeight+"px";newBoxStyle.overflow="hidden";Bk.Dom.addClass(newBox,"bk-fold");oldBox.parentNode.insertBefore(newBox,oldBox.nextSibling);if(isRemoteCall&&newBox.id=="bk-body"){Bk.Event.fireBkBodyLoaded(newBox);}
var evt={target:oldBox};oldBoxTransitionEnd(evt);var _startTransition=function(aNewBoxStyle,aHeight){Bk.animation.status.start({from:oldBox.id,to:newBox.id,transition:'unfold',isRemoteCall:isRemoteCall,nbOfCompletedCallRemaining:1});if(aNewBoxStyle.height===(aHeight+"px")){var msg='bk-fold class has a transition-property height\n'+'and the new value of the height is the same as the old\n'+'which means you will not receive a webkitTransitionEnd/transitionEnd event\n';console.warn(msg);}else{aNewBoxStyle.height=aHeight+"px";}};var _onNewBoxTransitionEnd=function(evt){var box=evt.target;Bk.Dom.removeClass(box,"bk-fold");box.style.overflow="";box.style.height="";Bk.Dom.remove_attr_if_empty("class",box);Bk.Dom.remove_attr_if_empty("style",box);Bk.animation.status.complete({from:oldBox.id,to:newBox.id,transition:'unfold'});};Bk.bindOnce(transitionendEventName,newBox,_onNewBoxTransitionEnd);_startTransition(newBoxStyle,newHeight);Bk.animation.listenToCreateLocationTimer(transitionendEventName,newBox);},flip:function(oldBox,newBox,ltr,isTransitionInplace,isRemoteCall,oldBoxTransitionEnd){var transitionEndEventName=window.Wopernizr.whichTransitionEvent();var isRemoteElement=newBox.parentNode?false:true;var oldBoxStyle=oldBox.style;var newBoxStyle=newBox.style;var isBackwards=ltr;var transition=ltr?"flip-backwards":"flip";if(!isBackwards){Bk.Dom.addClass(oldBox,"bk-front bk-rotate");Bk.Dom.addClass(newBox,"bk-back bk-rotate");}else{Bk.Dom.addClass(oldBox,"bk-back  bk-rotate bk-flip");Bk.Dom.addClass(newBox,"bk-front bk-rotate bk-flip");}
if(isRemoteCall){oldBox.parentNode.insertBefore(newBox,oldBox.nextSibling);}
if(!isRemoteCall||(newBox.style&&newBox.style.display!=="none")){newBoxStyle.display="block";}
Bk.animation.makeBoxAbsolute(oldBox,newBox,transitionEndEventName);var transitionEndCB=function(evt){var box=evt.target;console.log("transitionEndCB box.id="+box.id);box.removeAttribute('style');Bk.Dom.removeClass(box,"bk-rotate");if(box===oldBox){box.style.display="none";}
Bk.animation.status.complete({from:oldBox.id,to:newBox.id,transition:transition});};Bk.bindOnce(transitionEndEventName,oldBox,transitionEndCB);Bk.bindOnce(transitionEndEventName,newBox,transitionEndCB);Bk.animation.listenToCreateLocationTimer(transitionEndEventName,newBox);var transitionEndCallback=function(evt){evt.target.removeEventListener(evt.type,arguments.callee,false);oldBoxTransitionEnd(evt);};oldBox.addEventListener(transitionEndEventName,transitionEndCallback,false);window.requestAnimationFrame(function(){Bk.Dom.toggleClass(oldBox,"bk-flip");Bk.Dom.toggleClass(newBox,"bk-flip");Bk.animation.status.start({from:oldBox.id,to:newBox.id,transition:transition,isRemoteCall:isRemoteCall,nbOfCompletedCallRemaining:2});});},makeBoxAbsolute:function(box1,box2,eventName){var box1ComputedStyle=getComputedStyle(box1,null);var offset1=Bk.animation.offset(box1);var box2ComputedStyle=getComputedStyle(box2,null);var offset2=Bk.animation.offset(box2);var height1=parseInt(box1ComputedStyle.height,10);var height2=parseInt(box2ComputedStyle.height,10);var box=(height1<height2)?box1:box2;var top=(offset1.top<offset2.top)?offset1.top-Bk.animation.computeHeightOfTopAttributes(box1ComputedStyle):offset2.top-Bk.animation.computeHeightOfTopAttributes(box2ComputedStyle);box.style.position="absolute";box.style.top=top+"px";box.style.width=window.innerWidth+"px";box.addEventListener(eventName,function(evt){var box=evt.target;box.removeEventListener(evt.type,arguments.callee,false);box.style.position="";box.style.top="";box.style.width="";},false);},computeHeightOfTopAttributes:function(computedStyle){return parseInt(computedStyle.paddingTop,10)
+parseInt(computedStyle.borderTopWidth,10)
+parseInt(computedStyle.marginTop,10);},computeFullHeight:function(computedStyle){return parseInt(computedStyle.height,10)
+parseInt(computedStyle.paddingTop,10)
+parseInt(computedStyle.paddingBottom,10)
+parseInt(computedStyle.borderTopWidth,10)
+parseInt(computedStyle.borderBottomWidth,10)
+parseInt(computedStyle.marginTop,10)
+parseInt(computedStyle.marginBottom,10);},offset:function(elt){if(!elt){return{top:0,left:0};}
if(elt===elt.ownerDocument.body){console.warn("We do not handle offset.bodyOffset");return{top:0,left:0};}
Bk.animation._offsetInitialized||Bk.animation._initializeOffset();var elem=elt,offsetParent=elem.offsetParent,prevOffsetParent=elem,doc=elem.ownerDocument,computedStyle,docElem=doc.documentElement,body=doc.body,defaultView=doc.defaultView,prevComputedStyle=defaultView.getComputedStyle(elem,null),top=elem.offsetTop,left=elem.offsetLeft;while((elem=elem.parentNode)&&elem!==body&&elem!==docElem){computedStyle=defaultView.getComputedStyle(elem,null);top-=elem.scrollTop;left-=elem.scrollLeft;if(elem===offsetParent){if(computedStyle.position!=="relative"){top+=elem.offsetTop;left+=elem.offsetLeft;}
if(Bk.animation._offset.doesNotAddBorder&&!(Bk.animation._offset.doesAddBorderForTableAndCells&&/^t(able|d|h)$/i.test(elem.tagName))){top+=parseInt(computedStyle.borderTopWidth,10)||0;left+=parseInt(computedStyle.borderLeftWidth,10)||0;}
prevOffsetParent=offsetParent;offsetParent=elem.offsetParent;}
if(Bk.animation._offset.subtractsBorderForOverflowNotVisible&&computedStyle.overflow!=="visible"){top+=parseInt(computedStyle.borderTopWidth,10)||0;left+=parseInt(computedStyle.borderLeftWidth,10)||0;}
prevComputedStyle=computedStyle;}
if(prevComputedStyle.position==="relative"||prevComputedStyle.position==="static"){top+=body.offsetTop;left+=body.offsetLeft;}
if(prevComputedStyle.position==="fixed"){top+=docElem.scrollTop;left+=docElem.scrollLeft;}
return{top:top,left:left};},registerNodeInTransition:function(eventType,nodeA,nodeB){var indexA=Bk.animation.inTransition(nodeA);var indexB=nodeB?Bk.animation.inTransition(nodeB):-1;var dataA,dataB;if(indexA!==-1){dataA=Bk.animation.nodes[indexA];Bk.animation.nodes.splice(indexA,1);}
if(indexB!==-1){dataB=Bk.animation.nodes[indexB];Bk.animation.nodes.splice(indexB,1);}
if(dataA){Bk.animation.sendTransitionEndEvent(dataA.eventType,dataA.node);Bk.animation.sendTransitionEndEvent(dataA.eventType,dataA.otherNode);}
if(dataB){Bk.animation.sendTransitionEndEvent(dataB.eventType,dataB.node);Bk.animation.sendTransitionEndEvent(dataB.eventType,dataB.otherNode);}
var a={node:nodeA,eventType:eventType,otherNode:nodeB};Bk.animation.listenToUnregisterNodeInTransition(eventType,nodeA);Bk.animation.nodes.push(a);if(nodeB){var b={node:nodeB,eventType:eventType,otherNode:nodeA};Bk.animation.listenToUnregisterNodeInTransition(eventType,nodeB);Bk.animation.nodes.push(b);}},sendTransitionEndEvent:function(eventType,node){if(eventType==="webkitAnimationEnd"&&!window.WebKitAnimationEvent){Bk.Event.addListener("transitionEndListenerReady",window,function(){Bk.Event.createAndDispatchEvent("webkitTransitionEnd",node);});return;}else if(eventType==="animationEnd"&&!window.AnimationEvent){Bk.Event.addListener("transitionEndListenerReady",window,function(){Bk.Event.createAndDispatchEvent("transitionEnd",node);});return;}
var event;if(node){var computedStyle=getComputedStyle(node,null);if(eventType==="webkitAnimationEnd"){var animationName=computedStyle.webkitAnimationName;if(animationName&&animationName!=="none"){event=document.createEvent("WebKitAnimationEvent");event.initWebKitAnimationEvent("webkitAnimationEnd",true,true,animationName,0.0);node.dispatchEvent(event);}}else if(eventType==="animationEnd"){var animationName=computedStyle.AnimationName;if(animationName&&animationName!=="none"){event=document.createEvent("AnimationEvent");event.initAnimationEvent("animationEnd",true,true,animationName,0.0);node.dispatchEvent(event);}}
else if(eventType==="webkitTransitionEnd"){try{event=new WebKitTransitionEvent("webkitTransitionEnd",true,true,computedStyle.webkitTransitionProperty,0.0);}catch(ignore){event=document.createEvent("WebKitTransitionEvent");if(event.initWebKitTransitionEvent){event.initWebKitTransitionEvent("webkitTransitionEnd",true,true,computedStyle.webkitTransitionProperty,0.0);}
else{event.initEvent("webkitTransitionEnd",true,false);}}
node.dispatchEvent(event);}
else if(eventType==="transitionEnd"){try{event=new TransitionEvent("transitionEnd",true,true,computedStyle.transitionProperty,0.0);}catch(ignore){event=document.createEvent("TransitionEvent");event.initTransitionEvent("transitionEnd",true,true,computedStyle.transitionProperty,0.0);}
node.dispatchEvent(event);}}},inTransition:function(elem){var indexOf=-1;for(var i=0,length=Bk.animation.nodes.length;i<length&&indexOf===-1;i++){if(Bk.animation.nodes[i].node===elem){indexOf=i;}}
return indexOf;},listenToUnregisterNodeInTransition:function(eventType,node){var unregisterNode=function(evt){setTimeout(function(){var node=evt.target;if(!node){return;}
node.removeEventListener(evt.type,arguments.callee,false);var index=Bk.animation.inTransition(node);if(index!==-1){Bk.animation.nodes.splice(index,1);}},200);};node.addEventListener(eventType,unregisterNode,false);},listenToCreateLocationTimer:function(eventType,node){if(node){var createTimer=function(evt){evt.target.removeEventListener(evt.type,arguments.callee,false);};node.addEventListener(eventType,createTimer,false);}},_initializeOffset:function(){if(Bk.animation._offsetInitialized){return;}
var body=document.body,container=document.createElement('div'),innerDiv,checkDiv,table,td,rules,prop,bodyMarginTop=body.style.marginTop,html='<div style="position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;">'+'<div></div>'+'</div>'+'<table style="position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;" cellpadding="0" cellspacing="0">'+'<tr>'+'<td></td>'+'</tr>'+'</table>';rules={position:'absolute',top:0,left:0,margin:0,border:0,width:'1px',height:'1px',visibility:'hidden'};for(prop in rules){container.style[prop]=rules[prop];}
container.innerHTML=html;if(container.innerHTML===''){var _injectElements=function(container){var node=document.createElement('div');node.setAttribute("style",'position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;');container.appendChild(node);};_injectElements(container);}
if(container.innerHTML===''){console.error("container.innerHTML is still empty, aborting!");return;}
body.insertBefore(container,body.firstChild);innerDiv=container.firstChild;checkDiv=innerDiv.firstChild;td=innerDiv.nextSibling.firstChild.firstChild;Bk.animation._offset={};Bk.animation._offset.doesNotAddBorder=(checkDiv.offsetTop!==5);Bk.animation._offset.doesAddBorderForTableAndCells=(td.offsetTop===5);innerDiv.style.overflow='hidden';innerDiv.style.position='relative';Bk.animation._offset.subtractsBorderForOverflowNotVisible=(checkDiv.offsetTop===-5);body.style.marginTop='1px';Bk.animation._offset.doesNotIncludeMarginInBodyOffset=(body.offsetTop===0);body.style.marginTop=bodyMarginTop;body.removeChild(container);Bk.animation._offsetInitialized=true;},_initializeSupport:function(){if(Bk.animation._supportInitialized){return;}
var div=document.createElement("div");div.style.width=div.style.paddingLeft="1px";document.body.appendChild(div);Bk.boxModel=div.offsetWidth===2;document.body.removeChild(div).style.display='none';},};Bk.animation.status=(function(){var self={};var _STARTED="started";var _COMPLETED="completed";var _HASH_SEPARATOR="||";var _remote=undefined;var _current=[];var _unmatched=[];var _isRemote=function(){return _remote!=undefined;};var _updateRemote=function(args){if(_remote.loader){if(args.from==_remote.from){_remote.firstAnimationEnded=true;}
if(args.to==_remote.to){_remote.secondAnimationEnded=true;}
if(_remote.firstAnimationEnded&&_remote.secondAnimationEnded){_remote.completed=true;}}else{if(args.from==_remote.from&&args.to==_remote.to){_remote.completed=true;}}};var _isRemoteCompleted=function(){return _remote.completed;};var _isStarted=function(key){return _contains(key);};var _isCompleted=function(key){if(!_contains(key)){return false;}
var transition=_get(key);return transition.status==_COMPLETED;};var _isIdentifiedAsUnmatched=function(key){for(var i=0;i<_unmatched.length;i++){if(_unmatched[i]==key){return true;}}
return false;};var _contains=function(key){for(var i=0;i<_current.length;i++){if(_current[i].key==key){return true;}}
return false;};var _get=function(key){for(var i=0;i<_current.length;i++){if(_current[i].key==key){return _current[i];}}};var _areAllCompleted=function(){for(var i=0;i<_current.length;i++){if(_current[i].status==_STARTED){return false;}}
if(_isRemote()&&!_isRemoteCompleted()){return false;}
return true;};var _serialize=function(args){var hash="";if(args.id){hash+=args.id;hash+=_HASH_SEPARATOR;hash+=args.transition;}else{hash+=args.from;hash+=_HASH_SEPARATOR;hash+=args.to;hash+=_HASH_SEPARATOR;hash+=args.transition;}
return hash;};var _unserialize=function(hash){var array=hash.split(_HASH_SEPARATOR);var length=array.length;var obj={};if(length==2){obj.id=array[0];obj.transition=array[1];}else if(length==3){obj.from=array[0];obj.to=array[1];obj.transition=array[2];}else{console.warn("given hash is composed by non expected number of elements : "+length);}
return obj;};var _debug=function(record,event){var msg="--------";msg+=event+" animation: "+_toString(record);for(var i=0;i<_current.length;i++){var current=_current[i];msg+=i+": "+_toString(current);}
msg+="--------";return msg;};var _toString=function(record){var animation=_unserialize(record.key);var message="from="+animation.from;message+="  to="+animation.to;message+="  animation="+animation.transition;message+="  nbofcompletedcallremaining="+record.nbOfCompletedCallRemaining;message+="  status="+record.status;return message;};self.init=function(){console.debug("Initialization of animation status.");_current=[];_unmatched=[];_remote=undefined;};self.initRemote=function(impl){var loader,completed,from,to;loader=(impl.loader)?true:false;if(loader){from=impl.loader.from;to=impl.content.to;}else{from=impl.content.from;to=impl.content.to;}
_remote={loader:loader,completed:false,from:from,to:to,firstAnimationEnded:false,secondAnimationEnded:false}};self.updateBkTo=function(to){_remote.to=to;};self.start=function(args){var key=_serialize(args);if(!_contains(key)){var record={key:key,status:_STARTED,nbOfCompletedCallRemaining:args.nbOfCompletedCallRemaining};_current.push(record);console.debug(_debug(record,"started"));}
Bk.Event.fireBkAnimationStarted(args);};self.complete=function(args){var key=_serialize(args);if(_isStarted(key)&&!_isCompleted(key)){if(_isRemote()){_updateRemote(args);}
var transition=_get(key);transition.nbOfCompletedCallRemaining--;if(_isIdentifiedAsUnmatched(key)){transition.nbOfCompletedCallRemaining--;}
if(transition.nbOfCompletedCallRemaining===0){transition.status=_COMPLETED;Bk.Event.fireBkAnimationCompleted(args);}
console.debug(_debug(transition,"completed"));if(_areAllCompleted()){_current=[];Bk.Event.fireBkTransitionCompleted(args);}}else{if(!_isIdentifiedAsUnmatched(key)){_unmatched.push(key);console.debug("Animation with key="+key+" was identified as unmatched.");}}};return self;})();Bk.Head=(function(){"use strict";var self={};var SKIP_FLAG='data-bk-skip';var REMOVE_FLAG='data-bk-remove';var POSITION_FLAG='data-bk-position';var INSERT_BEFORE_FLAG='data-bk-insertBefore';var nbOfRemainingHeadChildsToLoad=0;var headChildsToLoad=[];Bk.onPageUnloaded(function(){nbOfRemainingHeadChildsToLoad=0;headChildsToLoad=[];});self.update=function(newDocument){if(newDocument){handleTitle(newDocument);handleMetas(newDocument);handleResources(newDocument);}else{Bk.Event.fireBkScriptsLoaded();}};var handleTitle=function(newDocument){var newTitle=newDocument.getElementsByTagName("title")[0];if(newTitle){newTitle=Bk.Dom.importNode(newTitle,true);var title=document.getElementsByTagName("title")[0];if(title){title.parentNode.replaceChild(newTitle,title);}else{document.getElementsByTagName("head")[0].appendChild(newTitle);}}};var handleMetas=function(newDocument){var head=document.getElementsByTagName("head")[0];var old_metas=document.getElementsByTagName("meta");while(old_metas.length!=0){head.removeChild(old_metas[0]);}
var new_metas=newDocument.getElementsByTagName("meta");for(var i=0;i<new_metas.length;i++){insertChild(head,new_metas[i]);}};var handleResources=function(newDocument){var head=document.getElementsByTagName("head")[0];var newHead=newDocument.getElementsByTagName("head")[0];handleOneKindOfResource(newHead,"link");handleOneKindOfResource(newHead,"style");handleOneKindOfResource(newHead,"script");if(!Bk.Dom.getElementById("bk-overlay",document)){var overlay=Bk.Dom.getElementById("bk-overlay",newDocument);if(overlay){document.body.appendChild(Bk.Dom.importNode(overlay,true));}}
nbOfRemainingHeadChildsToLoad=headChildsToLoad.length;if(nbOfRemainingHeadChildsToLoad==0){Bk.Event.fireBkScriptsLoaded();}else{for(var i=0;i<headChildsToLoad.length;i++){if(headChildsToLoad[i].hasAttribute(INSERT_BEFORE_FLAG)){var tagName=headChildsToLoad[i].nodeName.toLowerCase();var pos=headChildsToLoad[i].getAttribute(INSERT_BEFORE_FLAG);var insertBeforeElement=head.querySelector(tagName+"["+POSITION_FLAG+" = \""+pos+"\"]");headChildsToLoad[i].removeAttribute(INSERT_BEFORE_FLAG);insertChild(head,headChildsToLoad[i],insertBeforeElement);}else{insertChild(head,headChildsToLoad[i]);}}}
var nodesToClean=head.querySelectorAll("*["+POSITION_FLAG+"]");for(var i=0;i<nodesToClean.length;i++){nodesToClean[i].removeAttribute(POSITION_FLAG);}};var handleOneKindOfResource=function(newHead,tagName){var head=document.getElementsByTagName("head")[0];var curTags=document.getElementsByTagName(tagName);var newTags=newHead.getElementsByTagName(tagName);var found;var position=0;for(var i=0;i<curTags.length;i++){found=false;for(var j=0;j<newTags.length;j++){var comp=areEqualTags(curTags[i],newTags[j]);if(comp==true){newTags[j].setAttribute(SKIP_FLAG,"true");found=true;newTags[j].setAttribute(POSITION_FLAG,position);curTags[i].setAttribute(POSITION_FLAG,position);position++;break;}}
if(!found){curTags[i].setAttribute(REMOVE_FLAG,"true");}}
for(var i=0;i<curTags.length;i++){if(curTags[i].getAttribute(REMOVE_FLAG)=="true"){try{curTags[i].removeAttribute(REMOVE_FLAG);head.removeChild(curTags[i]);}catch(err){}
i--;}}
for(var j=0;j<newTags.length;j++){if(newTags[j].getAttribute(SKIP_FLAG)!="true"){if(!newTags[j].id){newTags[j].id="bk-temporary-id";}
var nextBoundary=newHead.querySelector(tagName+"[id = '"+newTags[j].id+"'] ~ "+tagName+"["+POSITION_FLAG+"]");if(nextBoundary){var pos=nextBoundary.getAttribute(POSITION_FLAG);newTags[j].setAttribute(INSERT_BEFORE_FLAG,pos);}
if(newTags[j].id==="bk-temporary-id"){newTags[j].id="";}
newTags[j].removeAttribute(SKIP_FLAG);headChildsToLoad.push(newTags[j]);}}
for(var j=0;j<newTags.length;j++){newTags[j].removeAttribute(POSITION_FLAG);}};var insertChild=function(head,node,anchorNode){if(isExternalStyleSheet(node)){handleExternalStyleSheet(head,node,anchorNode);}else if(isInlineStyleSheet(node)){handleInlineStyleSheet(head,node,anchorNode);}else if(isScript(node)){handleScript(head,node,anchorNode);}else{node=Bk.Dom.importNode(node,true);if(anchorNode){head.insertBefore(node,anchorNode)}else{head.appendChild(node);}
decrementNbOfRemainingHeadChildsToLoad();}};var isInlineStyleSheet=function(node){var isStyleSheet=node.getAttribute("type")==="text/css";return Bk.Dom.nodeName(node,"style");};var isExternalStyleSheet=function(node){var hasHref=node.getAttribute("href")!==null;var isStyleSheet=node.getAttribute("rel")==="stylesheet";return Bk.Dom.nodeName(node,"link")&&isStyleSheet&&hasHref;};var isScript=function(node){return Bk.Dom.nodeName(node,"script");};var isExternalJavaScript=function(node){return node.getAttribute("src")&&(node.getAttribute("src").indexOf("bk.js")==-1);};var handleInlineStyleSheet=function(head,node,anchorNode){node=Bk.Dom.importNode(node,true);if(anchorNode){head.insertBefore(node,anchorNode)}else{head.appendChild(node);}
decrementNbOfRemainingHeadChildsToLoad();};var handleScript=function(head,node,anchorNode){var newNode=document.createElement("script");if(node.getAttribute("id")){newNode.setAttribute("id",node.getAttribute("id"));}
if(node.getAttribute("type")){newNode.setAttribute("type",node.getAttribute("type"));}
if(node.innerHTML){newNode.innerHTML=node.innerHTML;}else if(node.childNodes[0]!=null){newNode.innerHTML=node.childNodes[0].nodeValue;}
if(isExternalJavaScript(node)){newNode.onload=newNode.onreadystatechange=function(){if(!this.readyState||this.readyState=="loaded"||this.readyState=="complete"){decrementNbOfRemainingHeadChildsToLoad();newNode.onload=newNode.onreadystatechange=null;}};newNode.onerror=function(){decrementNbOfRemainingHeadChildsToLoad();newNode.onerror=null;};newNode.setAttribute("src",node.getAttribute("src"));}else{decrementNbOfRemainingHeadChildsToLoad();}
if(anchorNode){head.insertBefore(newNode,anchorNode)}else{head.appendChild(newNode);}};var handleExternalStyleSheet=function(head,node,anchorNode){var nbOfLinks=document.styleSheets.length;var newNode=document.createElement('link');newNode.rel='stylesheet';newNode.href=node.getAttribute('href');newNode.type="text/css";waitStylesheetToBeCompletlyLoaded(nbOfLinks);if(anchorNode){head.insertBefore(newNode,anchorNode)}else{head.appendChild(newNode);}};var waitStylesheetToBeCompletlyLoaded=function(index){try{if(document.styleSheets[index].cssRules){decrementNbOfRemainingHeadChildsToLoad();}else{if(document.styleSheets[index].rules&&document.styleSheets[index].rules.length){decrementNbOfRemainingHeadChildsToLoad();}else{setTimeout(function(){waitStylesheetToBeCompletlyLoaded(index);},250);}}}
catch(e){setTimeout(function(){waitStylesheetToBeCompletlyLoaded(index);},250);}};var decrementNbOfRemainingHeadChildsToLoad=function(){nbOfRemainingHeadChildsToLoad--;if(nbOfRemainingHeadChildsToLoad===0){Bk.Event.fireBkScriptsLoaded();}};var areEqualTags=function(a,b){if(a===b){return true;}
if(a.nodeName.toLowerCase()!==b.nodeName.toLowerCase()){return false;}
var attrA=a.attributes;var attrB=b.attributes;if(attrA.length!==attrB.length){return false;}
for(var i=0;i<attrA.length;i++){if(attrA[i].nodeName==="href"|| attrA[i].nodeName==="src"){var _aLocation=a.getAttribute(attrA[i].nodeName);var _bLocation=b.getAttribute(attrA[i].nodeName);if(!compareLocations(_aLocation,_bLocation)){return false;}}else if(a.getAttribute(attrA[i].nodeName)!==b.getAttribute(attrA[i].nodeName)){return false;}}
return a.innerHTML===b.innerHTML;};var remove_jsessionid_or_similar=function(url){if(!url)return url;result=url.replace(new RegExp(";.+?=\\w\.+(?=\\?)"),"");if(result.length<url.length){console.debug("sessionId from the middle of the url was removed: ",result);return result;}
var result=url.replace(new RegExp(";.*=\\w\.+[^\\?&]+"),"");if(result.length<url.length){console.debug("★ tailing sessionid was removed: ",result);return result;}
return url;};var compareLocations=function(a,b){var _a=canonicalize(remove_jsessionid_or_similar(a));var _b=canonicalize(remove_jsessionid_or_similar(b));return _a===_b?true:false;};var canonicalize=function(url){var div=document.createElement("div");div.innerHTML="<a></a>";div.firstChild.href=url;div.innerHTML=div.innerHTML;return div.firstChild.href.split(";")[0];};return self;}());Bk.Form=(function(){"use strict";var self={};self.buildXHRData=function(form,submit){var elts=[];for(var i=0;i<form.elements.length;i++){elts.push(form.elements[i]);}
var inputImages=Bk.Dom.getElementsByAttribute(form,"input","type","image");for(var i=0;i<inputImages.length;i++){elts.push(inputImages[i]);}
var length=elts.length;var parameters=[];if(submit){var typeOfSubmittedElement=submit.getAttribute("type");}
for(var i=0;i<length;i++){var elt=elts[i];if(elt.name===""){continue;}
if(submit){var typeOfCurrentElement=elt.getAttribute("type");if(typeOfCurrentElement==="submit"||typeOfCurrentElement=="image"){if((typeOfCurrentElement!==typeOfSubmittedElement)||(elt.name!==submit.name)||(elt.value!==submit.value)){continue;}}}
if(!elt.disabled){var value=getFieldValue(elt);if(value!==undefined){var name=encodeURIComponent(elt.name);if(Bk.Util.isArray(value)){var vl=value.length;for(var v=0;v<vl;v++){parameters.push(name+"="+encodeURIComponent(value[v]));}}else{parameters.push(name+"="+encodeURIComponent(value));}}}}
return parameters;};self.doSubmitOnBack=function(submit){var submitOnBack=true;var flag=submit.getAttribute("data-bk-submit-on-back");if(flag&&flag==="false"){submitOnBack=false;}
return submitOnBack;};self.doPreserveMethodOnBack=function(elt){var preserveMethod=false;var flag=elt.getAttribute("data-bk-preserve-method-on-back");if(flag&&flag==="true"){preserveMethod=true;}
return preserveMethod;};var getFieldValue=function(elt){var value;if(Bk.Dom.nodeName(elt,"select")){var index=elt.selectedIndex;if(index<0){value=null;}else if(elt.type==="select-one"){value=selectOptionValue(elt.options[index]);}else{value=[];var options=elt.options;var length=options.length;for(var i=0;i<length;i++){var option=options[i];if(option.selected){value.push(selectOptionValue(option));}}}}else if(elt.type==="checkbox"||elt.type==="radio"){if(elt.checked){value=elt.value;}}else{value=elt.value||"";}
return value;};var selectOptionValue=function(elt){return(elt.attributes.value||{}).specified?elt.value:elt.text;};return self;}());Bk.Url=(function(){"use strict";var self={};var regExp=/^(((([^:\/#\?]+:)?(?:(\/\/)((?:(([^:@\/#\?]+)(?:\:([^:@\/#\?]+))?)@)?(([^:\/#\?\]\[]+|\[[^\/\]@#?]+\])(?:\:([0-9]+))?))?)?)?((\/?(?:[^\/\?#]+\/+)*)([^\?#]*)))?(\?[^#]+)?)(#.*)?/;var parse=function(url){var matches=regExp.exec(url||"")||[];return{href:matches[0]||"",hrefNoHash:matches[1]||"",hrefNoSearch:matches[2]||"",domain:matches[3]||"",protocol:matches[4]||"",doubleSlash:matches[5]||"",authority:matches[6]||"",username:matches[8]||"",password:matches[9]||"",host:matches[10]||"",hostname:matches[11]||"",port:matches[12]||"",pathname:matches[13]||"",directory:matches[14]||"",filename:matches[15]||"",search:matches[16]||"",hash:matches[17]||""};};self.isSameDomain=function(url1,url2){return parse(url1).domain===parse(url2).domain;};self.getLocation=function(){var location="";location+=window.location.protocol;location+="//";location+=window.location.host;location+=window.location.pathname;return location;};return self;}());Bk.Hash=(function(){"use strict";var self={};var PREFIX="_bk_";var SEP="#";self.get=function(){if(location.hash===""){return"";}
var hash=location.hash.substr(PREFIX.length+1);hash=hash.replace(/%23/g,"#");return hash;};self.getLocation=function(){var hash=self.get();if(hash){return self.unserialize(hash).url;}
return Bk.Url.getLocation();};self.getIndex=function(){var hash=self.get();if(hash){return self.unserialize(hash).index;}
return null;};self.getAnchor=function(){var hash=self.get();if(hash){return self.unserialize(hash).anchor;}
return null;};self.isPresent=function(){return window.location.hash.indexOf(PREFIX)>-1;};self.serialize=function(item){var hash="";hash+="x="+item.getIndex();hash+=SEP;var remote=item.getRemoteTransition();if(remote){hash+="u="+encodeURI(remote.getLocation());hash+=SEP;var anchorId=remote.getAnchorId();if(anchorId){hash+="a="+anchorId;hash+=SEP;}}else{var url=Bk.Hash.getLocation();hash+="u="+encodeURI(url);hash+=SEP;}
location.hash=PREFIX+hash;return hash;};self.unserialize=function(hash){var chunks=hash.split(SEP);var cl=chunks.length;var history={index:-1};var chunk,c;for(c=0;c<cl;c++){chunk=chunks[c];if(chunk.indexOf("x=")===0){history.index=parseInt(chunk.substr(2),10);}else if(chunk.indexOf("u=")===0){history.url=decodeURI(chunk.substr(2));}else if(chunk.indexOf("a=")===0){history.anchor=chunk.substr(2);}else if(chunk.indexOf("d=")===0){history.data=chunk.substr(2);if(history.data&&0<history.data.length){history.data=decodeURI(history.data).split("&");}}}
return history;};return self;}());Bk.History=(function(){"use strict";var self={};var remote={index:-1,stack:[]};var inplace={index:-1,stack:[]}
var index=-1;var item=null;var swapBackUnplayed=0;(function(){Bk.Event.addListener(Bk.Event.BK_LOCATION_CHANGED,document,function(evt){handleLocationChange(evt);});}());self.initContext=function(){index++;item=new HistoryItem(index);};self.releaseContext=function(){if(!item){return;}
var isSwap=item.isSwapTransition();var hasRemote=item.hasRemoteTransition();if(hasRemote){swapBackUnplayed+=inplace.stack.length;inplace.stack=[];inplace.index=-1;remote.stack.push(item);remote.index++;Bk.Hash.serialize(item);}else if(isSwap){if(item.isHistorizationEnabled()){inplace.stack.push(item);inplace.index++;Bk.Hash.serialize(item);}}else{remote.stack.pop();item=null;}};self.pushState=function(transition){item.addTransition(transition);var isRemote=transition.isRemote();if(isRemote){var previous=getPreviousRemoteTransition();transition.populateBackImplementation(previous);}};var handleLocationChange=function(evt){if(isRefresh(evt)){handleRefresh(evt);}
if(isBack(evt)){handleBack(evt);}};var isRefresh=function(evt){var index=Bk.Hash.getIndex();return(1<Math.abs(index<index)||(remote.stack.length===0&&inplace.stack.length===0));};var handleRefresh=function(evt){var url=Bk.Hash.getLocation();if(typeof url==="undefined"){return;}
if(!Bk.Url.isSameDomain(url,window.location)){return;}
window.location=url;return;};var isBack=function(evt){var hash=Bk.Hash.unserialize(evt.data.hash);return hash.index<index;};var handleBack=function(evt){popState();};var popState=function(){if(remote.stack.length===0){var delta=0-swapBackUnplayed;window.history.go(delta);return;}
var previous;if(inplace.stack.length!==0){previous=inplace.stack.pop();inplace.index--;}else{previous=remote.stack.pop();remote.index--;}
index--;previous.reverse();};var getPreviousRemoteTransition=function(){if(index==0){return null;}
var item=remote.stack[remote.index];if(!item){return null;}
return item.getRemoteTransition();};return self;}());function HistoryItem(index){this.index=index;this.transitions=[];}
HistoryItem.prototype.addTransition=function(transition){this.transitions.push(transition);};HistoryItem.prototype.getNbOfTransitions=function(){return this.transitions.length;};HistoryItem.prototype.hasRemoteTransition=function(){return this.getRemoteTransition()!=null;};HistoryItem.prototype.isSwapTransition=function(){for(var i=0;i<this.transitions.length;i++){if("SwapTransition"!==Bk.Util.getClassName(this.transitions[i])){return false;}}
return true;};HistoryItem.prototype.getRemoteTransition=function(){for(var i=0;i<this.transitions.length;i++){var transition=this.transitions[i];if(transition.isRemote()){return transition;}}
return null;};HistoryItem.prototype.reverse=function(){for(var i=0;i<this.transitions.length;i++){var transition=this.transitions[i];transition.reverse();}};HistoryItem.prototype.getIndex=function(){return this.index;};HistoryItem.prototype.isHistorizationEnabled=function(){for(var i=0;i<this.transitions.length;i++){if(this.transitions[i].isHistorizationEnabled()){return true;}}
return false;};Bk.LocationChangeListener=(function(){"use strict";var self={};var TIMER_DELAY=100;var timer=null;var lastHash="";(function(){Bk.onPageLoaded(function(){start();});}());var checkLocation=function(){if(isLocationChanged()){stop();Bk.Event.fireBkLocationChanged(lastHash);}};var isLocationChanged=function(){var changed=false;var currentHash=Bk.Hash.get();changed=currentHash!==lastHash;if(changed){lastHash=currentHash;}
return changed;};var start=function(){timer=setInterval(checkLocation,TIMER_DELAY);};var stop=function(){if(timer){clearInterval(timer);}};return self;}());Bk.TransitionFactory=(function(){var self={};self.buildAutomaticTransition=function(args){var location,section,animation,method,data,submitOnBack,preserveMethodOnBack,anchorId;if(args.link){location=args.link.href;animation=args.link.getAttribute("data-bk-transition")||"fade";method="get";data=null;submitOnBack=null;section=Bk.Body.id;}else if(args.form&&args.submit){location=args.form.action;method=args.form.method;animation=args.submit.getAttribute("data-bk-transition")||"fade";data=Bk.Form.buildXHRData(args.form,args.submit);section=Bk.Body.id;submitOnBack=Bk.Form.doSubmitOnBack(args.submit);preserveMethodOnBack=Bk.Form.doPreserveMethodOnBack(args.form);if(!preserveMethodOnBack){preserveMethodOnBack=Bk.Form.doPreserveMethodOnBack(args.submit);}}
anchorId=null;if(location&&location.indexOf("#")>-1&&location.split("#")[1]!=""){anchorId=location.split("#")[1];}
var transition={};transition.forward={location:location,method:method,data:data,submitOnBack:submitOnBack,preserveMethodOnBack:preserveMethodOnBack,loader:{from:section,to:Bk.Loader.getId(),animation:"none"},content:{from:Bk.Loader.getId(),to:section,animation:animation},anchorId:anchorId,};transition.back={location:Bk.Hash.getLocation(),method:"get",loader:{from:section,to:Bk.Loader.getId(),animation:"none"},content:{from:Bk.Loader.getId(),to:section,animation:Bk.animation.reverse(animation)}};return new AutomaticTransition(transition);};return self;}());function AutomaticTransition(data){var self=this;self.browserBackAction=false;self.backTransition=data.back;self.forwardTransition=data.forward;self.currentTransition=null;self.isRemote=function(){return true;};self.process=function(){Bk.Event.fireBkPageUnloaded();Bk.Event.fireBkTransitionStarted();self.currentTransition=(self.browserBackAction)?self.backTransition:self.forwardTransition;if(!self.browserBackAction){Bk.History.pushState(self);}
if(!self.currentTransition.location){console.warn("url argument is empty, replace operation aborted");return;}
Bk.animation.status.initRemote(self.currentTransition);var callback=function(){Bk.Ajax.fetch({location:window.location,url:self.currentTransition.location,method:self.currentTransition.method,data:self.currentTransition.data,checkResponse:true,onSuccess:function(xhr){self.handleXHRSuccess(xhr);},onTimeout:function(){self.handleXHRTimeout();},onError:function(xhr){self.handleXHRError(xhr);},onCustomError:function(xhr){self.handleXHRSuccess(xhr);}});};self.displayLoader(callback);};var _getFromElement=function(){return document.getElementById(self.currentTransition.loader.from);};self.displayLoader=function(callback){var fromElement=_getFromElement();var toElement=Bk.Loader.load();toElement.style.height=Bk.Loader.computeHeight()+"px";toElement.style.display='table';var cb=Bk.animation.impl("none");cb(fromElement,toElement,false,false,function(){Bk.Dom.hideInPage(fromElement);callback();});};self.handleXHRSuccess=function(xhr){var isPageTransition=Bk.Body.matches(self.currentTransition.content.to);var remoteDocument=Bk.Ajax.getXMLResponse(xhr);Bk.Event.fireBkRemoteDocumentRetrieved(remoteDocument);var displayRemote=function(){self.copyBodyAttributes(remoteDocument);self.copyHtmlAttributes(remoteDocument);Bk.Dom.removeNode(_getFromElement());var from=Bk.Loader.load();var to=null;if(isPageTransition){to=Bk.Body.extract(remoteDocument);}
var newLoaderEle=Bk.Dom.importContainer(remoteDocument,Bk.Loader.getId());var callback=undefined;if(!self.browserBackAction){if(self.getAnchorId()){callback=function(){Bk.Util.scrollTo(self.getAnchorId());};}else{callback=Bk.Util.hideURLBar;}}
self.display(from,to,callback,newLoaderEle);Bk.Event.removeListener(Bk.Event.BK_SCRIPTS_LOADED,document,displayRemote);};Bk.Event.addListener(Bk.Event.BK_SCRIPTS_LOADED,document,displayRemote);Bk.Head.update(remoteDocument);Bk.Header.update(remoteDocument);Bk.Footer.update(remoteDocument);};self.copyHtmlAttributes=function(remoteDocument){var currentHtml=document.getElementsByTagName('html')[0];var currentManifest=currentHtml.getAttribute("manifest");var remoteHtml=remoteDocument.getElementsByTagName('html')[0];var remoteManifest=remoteHtml.getAttribute("manifest");if(remoteManifest){currentHtml.setAttribute("manifest",remoteManifest);}else if(currentManifest){currentHtml.removeAttribute("manifest");}};self.copyBodyAttributes=function(remoteDocument){var currentBody=document.getElementsByTagName('body')[0];var remoteBody=remoteDocument.getElementsByTagName('body')[0];var currentBodyAttributes=currentBody.attributes;for(var i=0;i<currentBodyAttributes.length;i++){currentBody.removeAttribute(currentBodyAttributes.item(i).name);}
var remoteBodyAttributes=remoteBody.attributes;for(var i=0;i<remoteBodyAttributes.length;i++){if(remoteBodyAttributes.item(i).value){currentBody.setAttribute(remoteBodyAttributes.item(i).name,remoteBodyAttributes.item(i).value);}}};self.display=function(from,to,callback,newLoaderEle){var cb=Bk.animation.impl(self.currentTransition.content.animation);setTimeout(function(){cb(from,to,false,true,function(){Bk.Dom.hideInPage(from);Bk.Loader.update(newLoaderEle);if(callback){callback();}});},1);};self.onXHRError=function(callback){Bk.Head.update();var fromElement=Bk.Loader.load();var toElement;if(Bk.Body.id===_getFromElement().id){toElement=Bk.Body.load();}else{toElement=_getFromElement();}
Bk.Dom.showInPage(toElement);self.display(fromElement,toElement,callback);};self.handleXHRTimeout=function(args){var callback=function(){if(Bk.Debug.isEnabled()){Bk.Debug.handleServerTimeout({url:self.currentTransition.location});}};self.onXHRError(callback);};self.handleXHRError=function(xhr){var callback=function(){if(Bk.Debug.isEnabled()){if(!Bk.Ajax.isSuccess(xhr)){Bk.Debug.handleServerError({url:self.currentTransition.location,xhr:xhr});}else{Bk.Debug.handleNotXMLResponseError({xhr:xhr});}}};self.onXHRError(callback);};self.reverse=function(){self.browserBackAction=true;self.process();};self.getLocation=function(){return self.currentTransition.location;};self.getAnchorId=function(){return self.currentTransition.anchorId;};self.populateBackImplementation=function(previous){if(previous==null){return;}
self.backTransition.anchorId=previous.forwardTransition.anchorId;if(previous.forwardTransition.submitOnBack===false){self.backTransition.data=null;}else{self.backTransition.data=previous.forwardTransition.data;}
if(previous.forwardTransition.preserveMethodOnBack===true){self.backTransition.method=previous.forwardTransition.method;}else{self.backTransition.method=Bk.Ajax.GET;}};};function AbstractSectionTransition(args){var self=this;this.args=args;this.forwardTransition={type:"section",location:args.location,data:args.data,method:args.method||"get",submitOnBack:args.submitOnBack,preserveMethodOnBack:args.preserveMethodOnBack,anchorId:args.anchorId};this.forwardTransition.content={from:args.content.from,to:args.content.to,animation:args.content.transition};if(args.loader){this.forwardTransition.loader={from:args.loader.from,to:args.loader.to,animation:args.loader.transition}}
this.backTransition={type:"section",location:Bk.Hash.getLocation(),data:null,method:"get",anchorId:Bk.Hash.getAnchor()};if(args.loader){this.backTransition.loader={from:args.content.to,to:args.content.from,animation:Bk.animation.reverse(args.content.transition)};this.backTransition.content={from:args.loader.to,to:args.loader.from,animation:Bk.animation.reverse(args.loader.transition)}}else{this.backTransition.content={from:args.content.to,to:args.content.from,animation:Bk.animation.reverse(args.content.transition)}}
this.currentTransition=null;this.browserBackAction=false;this.loaderId=null;this.loaderParentId=null;this.isRemote=function(){return true;};this.process=function(){Bk.Event.fireBkPageUnloaded();Bk.Event.fireBkTransitionStarted();if(this.browserBackAction){this.currentTransition=this.backTransition;}else{this.currentTransition=this.forwardTransition;Bk.History.pushState(self);}
Bk.animation.status.initRemote(this.currentTransition);var from=this.getFromSection();if(!from){return;}
if(this.isLoaderSection()){var loader=this.getLoaderSection();if(!loader){return;}
this.displayLoader(from,loader);}
var parent=from.parentNode;Bk.Ajax.fetch({location:window.location,url:this.currentTransition.location,method:this.currentTransition.method,data:this.currentTransition.data,checkResponse:true,back:this.back,beforeSend:function(xhr){self.handleBeforeSend(xhr,self.currentTransition.data);},onSuccess:function(xhr){self.handleXHRSuccess(xhr);},onTimeout:function(){self.handleXHRTimeout(parent,from);},onError:function(xhr){self.handleXHRError(xhr,parent,from);},onCustomError:function(xhr){self.handleXHRCustomError(xhr);}});};this.getFromSection=function(){var id=(this.currentTransition.loader)?this.currentTransition.loader.from:this.currentTransition.content.from;var section=document.getElementById(id);if(!section){Bk.Debug.handleError("The section '"+id+"' does not exist in the current document.");}
return section;};this.isLoaderSection=function(){return this.currentTransition.loader!=null;};this.getLoaderSection=function(){var id=this.currentTransition.loader.to;var loader=document.getElementById(id);if(!loader){Bk.Debug.handleError("The loader section '"+id+"' does not exist in the current document.");}
return loader;};this.getRemoteSection=function(newDocument){var id=this.currentTransition.content.to;var section=newDocument.getElementById(id);if(!section){Bk.Debug.handleError("The section '"+id+"' does not exist in the remote document.");}
return section;};this.displayLoader=function(from,loader){var clone=this.cloneLoader(loader);var cb=function(elt,clone){animation=Bk.animation.impl(self.currentTransition.loader.animation);animation.call(window,elt,clone,false,true,Bk.animation.removeBoxCallback);self.currentTransition.loader.insertionTimeout=undefined;};Bk.Dom.showInPage(clone);this.currentTransition.loader.insertionTimeout=setTimeout(function(){cb(from,clone)},0);};this.cloneLoader=function(loader){var clone=loader.cloneNode(true);this.loaderId=(this.currentTransition.loader)?Bk.Util.createUUID():null;if(this.currentTransition.loader.to!==this.currentTransition.content.from){var from=Bk.Dom.getChildElementById(clone,this.currentTransition.content.from);if(from){this.loaderParentId=this.loaderId;this.loaderId=Bk.Dom.setNewId(from);}else{this.loaderId=this.currentTransition.content.from;}}
clone.setAttribute("id",this.loaderId);return clone;};this.displayRemoteSection=function(newDocument){if(!newDocument){return;}
var remoteSection=this.getRemoteSection(newDocument);if(!remoteSection){return;}
var transition=Bk.Dom.dataFromClass(remoteSection,"bk-transition-");if(!transition){transition=this.currentTransition.content.animation;}
var currentSectionId;if(this.loaderId&&this.currentTransition.loader.insertionTimeout===undefined){currentSectionId=this.loaderId;}else{if(this.currentTransition.loader&&this.currentTransition.loader.insertionTimeout!==undefined){currentSectionId=this.currentTransition.loader.from;clearTimeout(this.currentTransition.loader.insertionTimeout);this.currentTransition.loader.insertionTimeout===undefined;}else{currentSectionId=this.currentTransition.content.from;}}
var section=Bk.Dom.dataFromClass(remoteSection,"bk-to-");if(section){Bk.animation.status.updateBkTo(section);newSection=newDocument.getElementById(section);if(!newSection){var m="the element '"+section+"' does not exist in your remote document "+"('bk-to-' property in class attribute of '"+args.transition.content.to+"'), operation aborted"
console.warn(m);return;}
if(this.currentTransition.loader){if(this.currentTransition.content.from!==this.currentTransition.loader.to){this.currentTransition.content.from=this.currentTransition.loader.to;if(this.loaderParentId){currentSectionId=this.loaderParentId;this.loaderId=this.loaderParentId;}}}
remoteSection=newSection;}
var currentSection=document.getElementById(currentSectionId);if(!currentSection){console.warn("the old element '"+currentSectionId+"' does not exist (check your 'from' properties), operation aborted");return;}
remoteSection=Bk.Dom.importNode(remoteSection,true);if(this.currentTransition.anchorId){this.prepareAnchorScrolling();}
var cb=Bk.animation.impl(transition);cb(currentSection,remoteSection,false,true,Bk.animation.removeBoxCallback);};this.prepareAnchorScrolling=function(){var from=(self.currentTransition.loader)?self.loaderId:self.currentTransition.content.from;var to=self.currentTransition.content.to;var scrollToAnchor=function(evt){if(evt.data.from===from&&evt.data.to===to){setTimeout(function(){Bk.Util.scrollTo(self.currentTransition.anchorId)},0);Bk.Event.removeListener(Bk.Event.BK_ANIMATION_COMPLETED,document,scrollToAnchor);}}
Bk.Event.addListener(Bk.Event.BK_ANIMATION_COMPLETED,document,scrollToAnchor);};this.stop=function(parent,from,callback){Bk.Event.fireBkPageUnloaded();Bk.Head.update();if(this.currentTransition.loader){var to=from;var fromId=(this.currentTransition.loader)?this.loaderId:this.currentTransition.content.to;var from=document.getElementById(fromId);parent.appendChild(to);to.setAttribute(Bk.animation.KEEP_NODE,"");var transition=Bk.animation.reverse(this.currentTransition.loader.animation);var cb=Bk.animation.impl(transition);requestAnimationFrame(function(){cb(from,to,false,true,function(event){Bk.animation.removeBoxCallback(event);callback();});});}};this.reverse=function(){};this.handleBeforeSend=function(xhr,data){};this.handleXHRSuccess=function(xhr){var newDocument=Bk.Ajax.getXMLResponse(xhr);if(newDocument){Bk.Event.fireBkRemoteDocumentRetrieved(newDocument);Bk.Head.update(newDocument);this.displayRemoteSection(newDocument);}else if(xhr.responseText!==null){console.warn("We received a no XML response (check the Content-Type)");}};this.handleXHRTimeout=function(parent,from){var callback=function(){if(Bk.Debug.isEnabled()){Bk.Debug.handleServerTimeout({url:self.currentTransition.location});}};this.stop(parent,from,callback);};this.handleXHRError=function(xhr,parent,from){var callback=function(){if(Bk.Debug.isEnabled()){var isServerError=!Bk.Ajax.isSuccess(xhr);if(isServerError){Bk.Debug.handleServerError({url:self.currentTransition.location,xhr:xhr});}else{Bk.Debug.handleNotXMLResponseError({xhr:xhr});}}};this.stop(parent,from,callback);},this.handleXHRCustomError=function(xhr){this.currentTransition.content.to="bk-body";Bk.animation.status.remote.to=this.currentTransition.content.to;var newDocument=Bk.Ajax.getXMLResponse(xhr);if(newDocument){Bk.Event.fireBkRemoteDocumentRetrieved(newDocument);Bk.Head.update(newDocument);this.displayRemoteSection(newDocument);}else if(xhr.responseText!==null){console.warn("We received a no XML response (check the Content-Type)");}};this.reverse=function(){this.browserBackAction=true;this.process();};this.getLocation=function(){return this.currentTransition.location;};this.getAnchorId=function(){return this.currentTransition.anchorId;};this.populateBackImplementation=function(previous){if(previous==null){return;}
self.backTransition.anchorId=previous.forwardTransition.anchorId;if(previous.forwardTransition.submitOnBack===false){self.backTransition.data=null;}else{self.backTransition.data=previous.forwardTransition.data;}
if(previous.forwardTransition.preserveMethodOnBack===true){self.backTransition.method=previous.forwardTransition.method;}else{self.backTransition.method=Bk.Ajax.GET;}};};function ReplaceSectionTransition(args){var adapt=function(args){args.location=args.content.url;return args;};AbstractSectionTransition.call(this,adapt(args));};function SubmitSectionTransition(args,submit){var form=Bk.Dom.getElementById(args.content.form);var preserveMethodOnBack=Bk.Form.doPreserveMethodOnBack(form);if(!preserveMethodOnBack){preserveMethodOnBack=Bk.Form.doPreserveMethodOnBack(submit);}
var adapt=function(args){args.location=form.action;args.method=form.method;args.data=Bk.Form.buildXHRData(form,submit);args.submitOnBack=Bk.Form.doSubmitOnBack(submit);args.preserveMethodOnBack=preserveMethodOnBack;return args;};AbstractSectionTransition.call(this,adapt(args));};function SwapTransition(args){var self=this;this.fromId=args.from;this.from=document.getElementById(this.fromId);this.toId=args.to;this.to=document.getElementById(this.toId);this.animation=args.transition;this.historize=args.historize;this.back=args.back||false;this.isRemote=function(){return false;};this.isHistorizationEnabled=function(){return this.historize==="true";};this.process=function(){Bk.Head.update();if(!this.isDomReady()){return;}
Bk.Event.fireBkTransitionStarted();var impl=Bk.animation.impl(this.animation);if(impl===Bk.animation.doNone){Bk.Dom.hideInPage(this.from);Bk.Dom.showInPage(this.to);Bk.Event.fireBkTransitionCompleted(args);}else{Bk.Dom.showInPage(this.to);impl(this.from,this.to,true,false,Bk.animation.hideBoxCallback);}
if(!this.back){Bk.History.pushState(self);}};this.reverse=function(){var args={transition:Bk.animation.reverse(this.animation),from:this.toId,to:this.fromId,back:true};var reverse=new SwapTransition(args);reverse.process();delete reverse;};this.isDomReady=function(){if(!this.from){console.warn("There is no block with the id: "+this.fromId);return false;}
if(!this.to){console.warn("There is no block with the id: "+this.toId);return false;}
var display=getComputedStyle(this.from,null).getPropertyValue("display");if(display==="none"){console.info(this.fromId+" should be displayed");return false;}
display=getComputedStyle(this.to,null).getPropertyValue("display");if(display!=="none"){console.info(this.toId+" should be hidden");return false;}
return true;};}
function ToggleTransition(args){var self=this;self.args=args;this.id=args.id;this.section=document.getElementById(this.id);this.animation=args.transition;this.isRemote=function(){return false;};this.process=function(){if(!this.isDomReady()){return;}
Bk.Event.fireBkTransitionStarted();var computedStyle=getComputedStyle(this.section,null);var display="";if(computedStyle){display=computedStyle.getPropertyValue("display");}
var ie=window.ActiveXObject;if(ie){if(display==="none"){Bk.Dom.showInPage(this.section);}else{Bk.Dom.hideInPage(this.section);}
Bk.Event.fireBkTransitionCompleted(args);return;}
if(display==="none"){if(this.animation==="unfold"){this.foldInPage(false,Bk.Dom.showInPage,null);}else{Bk.Dom.showInPage(this.section);Bk.Event.fireBkTransitionCompleted(args);}}else{if(this.animation==="unfold"){this.foldInPage(true,null,Bk.Dom.hideInPage);}else{Bk.Dom.hideInPage(this.section);Bk.Event.fireBkTransitionCompleted(args);}}};this.reverse=function(){var args={id:this.id,transition:Bk.animation.reverse(this.animation)};var reverse=new ToggleTransition(args);reverse.process();delete reverse;}
this.isDomReady=function(){if(!this.section){console.warn("There is no block with the id: "+this.id);return false;}
return true;};this.foldInPage=function(fold,transitionStartCallback,transitionEndCallback){var transitionendEventName=window.Wopernizr.whichTransitionEvent();Bk.animation.registerNodeInTransition(transitionendEventName,self.section);var newBoxStyle=self.section.style;Bk.Dom.addClass(self.section,"bk-fold-old");var backupDisplay=newBoxStyle.display;if(!fold){newBoxStyle.position="relative";newBoxStyle.left=(2*window.innerWidth)+"px";newBoxStyle.display="block";}
var height=parseInt(getComputedStyle(self.section,null).height,10);if(!fold){newBoxStyle.height="0";newBoxStyle.display=backupDisplay;}else{newBoxStyle.height=(fold)?height+"px":"";}
if(transitionStartCallback){transitionStartCallback(self.section);}
var newBoxTransitionEndCB=function(evt){setTimeout(function(){var box=evt.target;Bk.Dom.removeClass(box,"bk-fold");box.style.height="";if(transitionEndCallback){transitionEndCallback(box);}
Bk.animation.status.complete({id:self.id,transition:'toggle'});},200);};Bk.bindOnce(transitionendEventName,self.section,newBoxTransitionEndCB);Bk.Event.createAndDispatchEvent("transitionEndListenerReady");Bk.animation.listenToCreateLocationTimer(transitionendEventName,self.section);var transitionStart=function(aNewBox,aFold){Bk.animation.status.start({id:self.id,transition:'toggle',isRemoteCall:false,nbOfCompletedCallRemaining:1});Bk.Dom.addClass(aNewBox,"bk-fold");window.setTimeout(function(){var boxStyle=aNewBox.style;if(aFold){boxStyle.height="0px";}else{boxStyle.position="";boxStyle.left="";boxStyle.height=height+"px";}},50);};setTimeout(function(){transitionStart(self.section,fold);},50);};}
Bk.webAnalytics={};Bk.Chart=function(){};Bk.Chart.prototype._built_while_my_parent_was_visible=true;Bk.Chart.prototype.transitionsCompletedHandler=function(args){var toID=args.e.data.to||args.e.data.id;var mayBeParentNode=Bk.Dom.findParentNodeByAttr('id',toID,args.container);if(mayBeParentNode){var parent=mayBeParentNode;if(parent.style.display==="block"){args.container.style.visibility="visible";args.redraw();}
Bk.Event.removeListener(Bk.Event.BK_TRANSITION_COMPLETED,document,args.onTransitionsCompleted);}};Bk.Chart.Line=function(){var self=new Bk.Chart();var CS={X_AXIS_LABEL_HEIGHT:20,Y_AXIS_LABEL_LENGTH_FROM_Y_AXIS:10,MARGIN:20,TICK_LENGTH:4,LEGEND_PADDING_TOP:20,LENGTH_BETWEEN_EACH_TICKS:80};var _vis=null;var _group=null;var _xData=null;var _yDataArr=null;var _settings=null;var _jsonlines=null;var _onOrientationChangeEventName="";var _container=null;var _buildTriggerEvent=null;function _init(xData,yDataArr,settings,jsonlines,event){_container=document.getElementById(settings.containerId);if(!_container){console.warn("Unable to find the line chart container with id: ["+settings.containerId+"]. Aborting!");return;}
var parentNode=_container.parentNode;if(Bk.Dom.hasClass(parentNode,'bk-popup')){parentNode.style.display="block";}
CS.SVG_WIDTH=Bk.Util.getWidth(_container);if(!CS.SVG_WIDTH){CS.SVG_WIDTH=Bk.Util.getParentWidth(_container);_container.style.visibility="hidden";self._built_while_my_parent_was_visible=false;}
CS.SVG_HEIGHT=(CS.SVG_WIDTH*0.75);CS.NB_OF_X_TICKS=Math.round(CS.SVG_WIDTH/CS.LENGTH_BETWEEN_EACH_TICKS);CS.NB_OF_Y_TICKS=Math.round(CS.SVG_HEIGHT/CS.LENGTH_BETWEEN_EACH_TICKS);_xData=xData;_yDataArr=yDataArr;_settings=settings;_jsonlines=jsonlines;_buildTriggerEvent=event||_buildTriggerEvent;};function _draw(xData,yDataArr,settings,jsonlines){var yMin=d3.min(yDataArr,function(d){return d3.min(d.values)});var yMax=d3.max(yDataArr,function(d){return d3.max(d.values)});var xMin=d3.min(xData.values);var xMax=d3.max(xData.values);var y=d3.scale.linear().domain([yMin,yMax]).range([0+CS.MARGIN,CS.SVG_HEIGHT-CS.MARGIN]);var x=d3.scale.linear().domain([xMin,xMax]).range([0+CS.MARGIN+CS.Y_AXIS_LABEL_LENGTH_FROM_Y_AXIS+CS.MARGIN,CS.SVG_WIDTH-CS.MARGIN]);_vis=d3.select(_container).append("svg:svg").attr("width",CS.SVG_WIDTH).attr("height",CS.SVG_HEIGHT+CS.X_AXIS_LABEL_HEIGHT);_group=_vis.append("svg:g").attr("transform","translate(0, "+CS.SVG_HEIGHT+")");_group.append("svg:rect").attr("x",x(xMin)).attr("y",-1*y(yMax)).attr("width",x(xMax)-x(xMin)).attr("height",y(yMax)-CS.MARGIN).attr("style","fill:"+settings.chartbgcolor+";stroke:"+settings.chartbgcolor+";stroke-width:1.5px");_group.selectAll(".xGrid").data(x.ticks(CS.NB_OF_X_TICKS*2)).enter().append("svg:line").attr("x1",function(d){return x(d);}).attr("x2",function(d){return x(d);}).attr("y1",-1*y(yMin)).attr("y2",-1*y(yMax)).attr("class","bk-chart-grid-line");_group.selectAll(".yGrid").data(y.ticks(CS.NB_OF_Y_TICKS*2)).enter().append("svg:line").attr("class","bk-chart-grid-line").attr("y1",function(d){return-1*y(d);}).attr("y2",function(d){return-1*y(d);}).attr("x1",x(xMin)).attr("x2",x(xMax));_group.append("svg:line").attr("x1",x(xMin)).attr("x2",x(xMax)).attr("y1",-1*y(yMin)).attr("y2",-1*y(yMin)).attr("class","bk-x-axis");_group.append("svg:line").attr("x1",x(xMin)).attr("x2",x(xMin)).attr("y1",-1*y(yMin)).attr("y2",-1*y(yMax)).attr("class","bk-y-axis");_group.append("svg:text").attr("text-anchor","middle").attr("x",(x.range()[1]/2)+CS.MARGIN).attr("y",CS.X_AXIS_LABEL_HEIGHT).append("svg:tspan").text(settings.xAxisLabel);_group.append("svg:text").attr("transform","rotate(-90)").attr("text-anchor","middle").attr("x",(y.range()[1]/2)).attr("y",y(yMin)-CS.Y_AXIS_LABEL_LENGTH_FROM_Y_AXIS).text(settings.yAxisLabel);_group.selectAll(".xTicks").data(x.ticks(CS.NB_OF_X_TICKS)).enter().append("svg:line").attr("class","bk-x-ticks").attr("x1",function(d){return x(d);}).attr("x2",function(d){return x(d);}).attr("y1",-1*y(yMin)-2).attr("y2",-1*y(yMin)+2);_group.selectAll(".yTicks").data(y.ticks(CS.NB_OF_Y_TICKS)).enter().append("svg:line").attr("class","bk-y-ticks").attr("y1",function(d){return-1*y(d);}).attr("y2",function(d){return-1*y(d);}).attr("x1",x(xMin)-CS.TICK_LENGTH/2).attr("x2",x(xMin)+CS.TICK_LENGTH/2);_group.selectAll(".xLabel").data(x.ticks(CS.NB_OF_X_TICKS)).enter().append("svg:text").attr("class","xLabel").text(String).attr("x",function(d){return x(d);}).attr("y",-1*y(yMin)+CS.MARGIN).attr("text-anchor","middle");_group.selectAll(".yLabel").data(y.ticks(CS.NB_OF_Y_TICKS)).enter().append("svg:text").attr("class","yLabel").text(String).attr("x",(y(yMin))).attr("y",function(d){return-1*y(d);}).attr("text-anchor","right").attr("dy",4);for(var i=0;i<yDataArr.length;i++){self.lines[i]=d3.svg.line().x(function(d,i){var xTmp=x(xData.values[i]);return xTmp;}).y(function(d){var yTmp=-1*y(d);return yTmp;});var zeroArr=[];for(var j=0;j<yDataArr[i].values.length;j++){zeroArr[j]=yMin;}}
self.drawLegend(x);for(var i=0;i<self.lines.length;i++){_group.append("svg:path").attr("d",self.lines[i](zeroArr)).attr("style","stroke:"+jsonlines[i].color).transition().duration(1000).attr("d",self.lines[i](yDataArr[i].values));}
if(_buildTriggerEvent&&_buildTriggerEvent.data.callback){_buildTriggerEvent.data.callback();}
Bk.Event.fireEvent(Bk.Event.BK_CHART_BUILT);};var _redraw=function(){self.destroy();self.build(_xData,_yDataArr,_settings,_jsonlines);};var _react=function(){_onOrientationChangeEventName=Bk.Event.onOrientationChange(_redraw);if(!self._built_while_my_parent_was_visible){Bk.on(Bk.Event.BK_TRANSITION_COMPLETED,_onTransitionsCompleted);}
Bk.bindOnce(Bk.Event.BK_PAGE_UNLOADED,document,function(){Bk.Event.removeListener(_onOrientationChangeEventName,window,_redraw);Bk.Event.removeListener(Bk.Event.BK_TRANSITION_COMPLETED,document,_onTransitionsCompleted);});};var _onTransitionsCompleted=function(e){self.transitionsCompletedHandler({e:e,redraw:_redraw,container:_container,onTransitionsCompleted:_onTransitionsCompleted});_container.style.height="";};self.lines=[];self.build=function(xData,yDataArr,settings,jsonlines,e){setTimeout(function(){_init(xData,yDataArr,settings,jsonlines,e);_draw(xData,yDataArr,settings,jsonlines);_react();},500);};self.destroy=function(){Bk.Event.removeListener(_onOrientationChangeEventName,window,_redraw);Bk.Event.removeListener(Bk.Event.BK_TRANSITION_COMPLETED,document,_onTransitionsCompleted);if(_vis){_vis[0][0].parentNode.removeChild(_vis[0][0]);}};self.drawLegend=function(x){var yTranslate=CS.SVG_HEIGHT+CS.LEGEND_PADDING_TOP+CS.X_AXIS_LABEL_HEIGHT;var svgElement=d3.select(_container).select('svg');var wrap=svgElement.append("svg:g").attr("text-anchor","middle").attr("transform","translate(0, "+(yTranslate)+")").data([_jsonlines]);var legend=d3Legend();legend.color(_settings.color);legend.width(CS.SVG_WIDTH);wrap.datum(_jsonlines).call(legend);var newHeight=CS.SVG_HEIGHT+CS.X_AXIS_LABEL_HEIGHT+CS.LEGEND_PADDING_TOP+legend.height();svgElement.attr("height",newHeight);var bbox=wrap[0][0].getBBox();var delta=CS.SVG_WIDTH-CS.MARGIN-bbox.width;if(delta>0){var xTranslate=(-1*(delta/2))+CS.MARGIN;wrap.attr("transform","translate("+xTranslate+", "+(yTranslate)+")");}};return self;};Bk.Chart.Pie=function(){"use strict";var self=new Bk.Chart();var CS={MARGIN:20,LEGEND_PADDING:10,TRANSITION_DURATION:1500};var _container=null;var _vis=null;var _settings=null;var _data=null;var _buildTriggerEvent=null;var _onOrientationChangeEventName="";function _init(settings){if(_settings===null){_settings=settings;}
_container=Bk.Dom.getElementById(_settings.id);if(!_container){console.warn("Unable to find the pie chart container with id: ["+_settings.id+"]. Aborting!");return;}
_data=_settings.data;_buildTriggerEvent=_settings.buildTriggerEvent||_buildTriggerEvent;CS.SVG_WIDTH=Bk.Capabilities.SCREEN_WIDTH;var _parentNode=_container.parentNode;if(Bk.Dom.hasClass(_parentNode,'bk-popup')){_parentNode.style.display="block";}
CS.SVG_WIDTH=window.getComputedStyle(_container).getPropertyValue('width').replace("px","");CS.SVG_WIDTH=Bk.Util.getWidth(_container);if(!CS.SVG_WIDTH){CS.SVG_WIDTH=Bk.Util.getParentWidth(_container);_container.style.visibility="hidden";self._built_while_my_parent_was_visible=false;}
CS.PIE_WIDTH=(CS.SVG_WIDTH>300)?300:(CS.SVG_WIDTH-CS.MARGIN);CS.PIE_HEIGHT=(CS.SVG_WIDTH>300)?300:(CS.SVG_WIDTH-CS.MARGIN);CS.PIE_RADIUS=(Math.min(CS.PIE_WIDTH,CS.PIE_HEIGHT)/2)-(CS.MARGIN);};function _draw(){var arc=d3.svg.arc().outerRadius(CS.PIE_RADIUS);var donut=d3.layout.pie();_vis=d3.select(_container).append("svg:svg").data([_data]).attr("width",CS.SVG_WIDTH);var arcs=_vis.selectAll("g.arc").data(donut.value(function(d){return d.data})).enter().append("svg:g").attr("class","arc").attr("transform","translate("+(CS.SVG_WIDTH/2)+","+(CS.PIE_RADIUS+CS.MARGIN)+")");var paths=arcs.append("path").attr("fill",function(d){return d.data.color;}).attr("d",arc);paths.transition().duration(1500).attrTween("d",function(b){b.innerRadius=0;var i=d3.interpolate({startAngle:0,endAngle:0},b);return function(t){return arc(i(t));};});var legendData=[];for(var i=0;i<_data.length;i++){var item=_data[i];legendData[i]={label:item.label+" ("+item.data+")",color:item.color};}
var legend=d3Legend();legend.width(CS.SVG_WIDTH);var group=_vis.append("svg:g");group.datum(legendData).call(legend);var xTranslate=0;var yTranslate=CS.PIE_HEIGHT+CS.LEGEND_PADDING;var bbox=group[0][0].getBBox();var delta=CS.SVG_WIDTH-CS.MARGIN-bbox.width;if(delta>0){var xTranslate=(-1*(delta/2))+CS.MARGIN;group.attr("transform","translate("+xTranslate+", "+yTranslate+")");}
_vis.attr("height",CS.PIE_HEIGHT+legend.height()+CS.LEGEND_PADDING);if(_buildTriggerEvent&&_buildTriggerEvent.data.callback){_buildTriggerEvent.data.callback();}
Bk.Event.fireEvent(Bk.Event.BK_CHART_BUILT);}
var _redraw=function(){self.destroy();self.build(_settings);};var _react=function(){_onOrientationChangeEventName=Bk.Event.onOrientationChange(_redraw);if(!self._built_while_my_parent_was_visible){Bk.on(Bk.Event.BK_TRANSITION_COMPLETED,_onTransitionsCompleted);}
Bk.bindOnce(Bk.Event.BK_PAGE_UNLOADED,document,function(){Bk.Event.removeListener(_onOrientationChangeEventName,window,_redraw);Bk.Event.removeListener(Bk.Event.BK_TRANSITION_COMPLETED,document,_onTransitionsCompleted);});};var _onTransitionsCompleted=function(e){self.transitionsCompletedHandler({e:e,redraw:_redraw,container:_container,onTransitionsCompleted:_onTransitionsCompleted});};self.destroy=function(){Bk.Event.removeListener(_onOrientationChangeEventName,window,_redraw);Bk.Event.removeListener(Bk.Event.BK_TRANSITION_COMPLETED,document,_onTransitionsCompleted);if(_vis){_vis[0][0].parentNode.removeChild(_vis[0][0]);}};self.build=function(settings){setTimeout(function(){_init(settings);_draw();_react();},500);};return self;};Bk.Chart.Bar=function(){var self=new Bk.Chart();var CS={INITIAL_MARGIN_HORIZONTAL:30,MARGIN_BOTTOM:40,MARGIN_TOP:10,TICK_LENGTH:4,BAR_VALUE_VERTICAL_OFFSET:6,X_AXIS_LABEL_MARGIN_TOP:21,Y_AXIS_LABEL_MARGIN_RIGHT:14,Y_TICK_LABEL_MARGIN_RIGHT:10,BAR_LABEL_FONT_SIZE_POSITION_CORRECTION:-5,LENGTH_BETWEEN_EACH_TICKS:80,GRAPH_TOP_PADDING:14};var _onOrientationChangeEventName=null;var _vis=null;var _data=null;var _settings=null;var _container=null;var _buildTriggerEvent=null;function _init(data,settings,event){_container=document.getElementById(settings.containerId);if(!_container){console.warn("✘ Unable to find the bar chart container with id: ["+settings.containerId+"]. Aborting!");return;}
var lengthOfTheLongestYValue=d3.max(data,function(datum){return((datum.data+"").split(".")[0]).length});CS.MARGIN_HORIZONTAL=(lengthOfTheLongestYValue)*5+CS.INITIAL_MARGIN_HORIZONTAL;var parentNode=_container.parentNode;if(Bk.Dom.hasClass(parentNode,'bk-popup')){parentNode.style.display="block";}
CS.SVG_WIDTH=Bk.Util.getWidth(_container);if(!CS.SVG_WIDTH){CS.SVG_WIDTH=Bk.Util.getParentWidth(_container);_container.style.visibility="hidden";self._built_while_my_parent_was_visible=false;}
CS.SVG_HEIGHT=CS.SVG_WIDTH*0.75;CS.GRAPH_WIDTH=CS.SVG_WIDTH-CS.MARGIN_HORIZONTAL*2;CS.GRAPH_HEIGHT=CS.SVG_HEIGHT-(CS.MARGIN_TOP+CS.MARGIN_BOTTOM);CS.BAR_WIDTH=(2*CS.GRAPH_WIDTH)/((3*data.length)+1);CS.FIRST_BAR_LEFT_AND_LAST_BAR_RIGHT_MARGIN=CS.BAR_WIDTH/2;CS.NB_OF_Y_TICKS=Math.round(CS.GRAPH_HEIGHT/CS.LENGTH_BETWEEN_EACH_TICKS);_data=data;_settings=settings;_buildTriggerEvent=event||_buildTriggerEvent;};function _draw(data,settings){_vis=d3.select(_container).append("svg:svg").attr("width",CS.SVG_WIDTH).attr("height",CS.SVG_HEIGHT);var x=d3.scale.linear().domain([0,data.length-1]).range([CS.FIRST_BAR_LEFT_AND_LAST_BAR_RIGHT_MARGIN,CS.GRAPH_WIDTH-(CS.BAR_WIDTH+CS.FIRST_BAR_LEFT_AND_LAST_BAR_RIGHT_MARGIN)]);var max=d3.max(data,function(datum){return datum.data;});var y=d3.scale.linear().domain([0,max]).rangeRound([0,CS.GRAPH_HEIGHT-CS.GRAPH_TOP_PADDING-CS.BAR_VALUE_VERTICAL_OFFSET]);var cartesianCoor="translate("+CS.MARGIN_HORIZONTAL+", "+(CS.MARGIN_TOP+CS.GRAPH_HEIGHT)+") scale(1, -1)";var group=_vis.append("svg:g").attr("transform",cartesianCoor);group.append("svg:rect").attr("x",0).attr("y",0).attr("width",CS.GRAPH_WIDTH).attr("height",CS.GRAPH_HEIGHT).attr("style","fill:"+settings.chartbgcolor);group.selectAll(".yGrid").data(y.ticks(CS.NB_OF_Y_TICKS*2)).enter().append("svg:line").attr("y1",function(d){return y(d);}).attr("y2",function(d){return y(d);}).attr("x1",0).attr("x2",CS.GRAPH_WIDTH).attr("class","bk-chart-grid-line");group.selectAll("g").data(data).enter().append("svg:rect").attr("x",function(datum,index){return x(index);}).attr("y",0).attr("width",CS.BAR_WIDTH).attr("fill",function(datum){return datum.color;}).transition("height").duration(1000).attr("height",function(datum){return y(datum.data);});group.selectAll("g").data(data).enter().append("svg:text").text(function(datum){return(datum.data);}).attr("transform","scale(1, -1)").attr("x",function(datum,index){return x(index)+CS.BAR_WIDTH/2;}).attr("y",(-1*CS.BAR_VALUE_VERTICAL_OFFSET)).transition("x","y").duration(1000).attr("y",function(datum){return-1*(y(datum.data)+CS.BAR_VALUE_VERTICAL_OFFSET);}).attr("class","bk-chart-bar-value").attr("text-anchor","middle");var yValueArr=[];var parentNode=_container.parentNode;var oldDisplay=parentNode.style.display;if(parentNode.style.display==='none'){parentNode.style.display='block';}
group.selectAll("xTickLabel").data(data).enter().append("svg:text").text(function(d){return d.label;}).attr("transform",function(d,index,This){var originalXValue=x(index)+(CS.BAR_WIDTH/2)+CS.BAR_LABEL_FONT_SIZE_POSITION_CORRECTION;var originalYValue=0;var bbox=this.getBBox();var textWidth=bbox.width;var textHeight=bbox.height;var x45DegOrientedTextOffset=(Math.sqrt(2)/2)*(textWidth-textHeight);var y45DegOrientedTextOffset=(Math.sqrt(2)/2)*(textWidth+textHeight);xValue=originalXValue-x45DegOrientedTextOffset;yValue=-1*(originalYValue+y45DegOrientedTextOffset);yValueArr.push(Math.abs(yValue));return"translate("+xValue+", "+yValue+")"+" rotate(45) scale(1, -1)";}).attr("class","bk-xTickLabel");parentNode.style.display=oldDisplay;_vis.attr("height",d3.max(yValueArr)+CS.SVG_HEIGHT);group.append("svg:line").attr("x1",0).attr("x2",CS.GRAPH_WIDTH).attr("y1",0).attr("y2",0).attr("class","bk-x-axis");group.append("svg:line").attr("x1",0).attr("x2",0).attr("y1",0).attr("y2",CS.GRAPH_HEIGHT).attr("class","bk-x-axis");group.selectAll(".yTicks").data(y.ticks(CS.NB_OF_Y_TICKS)).enter().append("svg:line").attr("class","bk-y-ticks").attr("y1",function(d){return y(d);}).attr("y2",function(d){return y(d);}).attr("x1",0-CS.TICK_LENGTH/2).attr("x2",0+CS.TICK_LENGTH/2);var yTicksLabelMaximumLength=0;group.selectAll(".bk-yTickLabel").data(y.ticks(CS.NB_OF_Y_TICKS)).enter().append("svg:text").attr("class","bk-yTickLabel").text(String).attr("x",function(d,index,This){var bbox=this.getBBox();var textWidth=bbox.width;yTicksLabelMaximumLength=(yTicksLabelMaximumLength>=textWidth)?yTicksLabelMaximumLength:textWidth;return-1*(textWidth+CS.Y_TICK_LABEL_MARGIN_RIGHT);}).attr("y",function(d){return-1*y(d);}).attr("text-anchor","right").attr("transform","scale(1,-1)").attr("dy",4);group.append("svg:text").attr("text-anchor","middle").attr("transform","scale(1, -1)").attr("x",CS.GRAPH_WIDTH/2).attr("y",d3.max(yValueArr)+CS.X_AXIS_LABEL_MARGIN_TOP).attr("class","bk-xAxisTitle").append("svg:tspan").text(settings.xlabel);group.append("svg:text").text(settings.ylabel).attr("transform","rotate(90) scale(1, -1)").attr("x",function(){var bbox=this.getBBox();var textWidth=bbox.width;return(CS.GRAPH_HEIGHT-textWidth)/2;}).attr("y",-1*(CS.Y_AXIS_LABEL_MARGIN_RIGHT+yTicksLabelMaximumLength+CS.Y_TICK_LABEL_MARGIN_RIGHT)).attr("class","bk-yAxisTitle");var gOffset=(_vis.attr("width")-group[0][0].getBBox().width)/2;gOffset+=CS.MARGIN_HORIZONTAL;group.attr("transform","translate("+(gOffset)+", "+(CS.MARGIN_TOP+CS.GRAPH_HEIGHT)+") scale(1, -1)");if(_buildTriggerEvent&&_buildTriggerEvent.data.callback){_buildTriggerEvent.data.callback();}
Bk.Event.fireEvent(Bk.Event.BK_CHART_BUILT);};var _redraw=function(){self.destroy();self.build(_data,_settings);};var _onTransitionsCompleted=function(e){self.transitionsCompletedHandler({e:e,redraw:_redraw,container:_container,onTransitionsCompleted:_onTransitionsCompleted});};self.destroy=function(){Bk.Event.removeListener(_onOrientationChangeEventName,window,_redraw);Bk.Event.removeListener(Bk.Event.BK_TRANSITION_COMPLETED,document,_onTransitionsCompleted);if(_vis){_vis[0][0].parentNode.removeChild(_vis[0][0]);}};var _react=function(){_onOrientationChangeEventName=Bk.Event.onOrientationChange(_redraw);if(!self._built_while_my_parent_was_visible){Bk.on(Bk.Event.BK_TRANSITION_COMPLETED,_onTransitionsCompleted)}
Bk.bindOnce(Bk.Event.BK_PAGE_UNLOADED,document,function(){Bk.Event.removeListener(_onOrientationChangeEventName,window,_redraw);Bk.Event.removeListener(Bk.Event.BK_TRANSITION_COMPLETED,document,_onTransitionsCompleted);});};self.build=function(data,settings,e){setTimeout(function(){_init(data,settings,e);_draw(data,settings);_react();},500);};return self;};(function(){var lastTime=0;var vendors=['ms','moz','webkit','o'];for(var x=0;x<vendors.length&&!window.requestAnimationFrame;++x){window.requestAnimationFrame=window[vendors[x]+'RequestAnimationFrame'];window.cancelAnimationFrame=window[vendors[x]+'CancelAnimationFrame']||window[vendors[x]+'CancelRequestAnimationFrame'];}
if(!window.requestAnimationFrame){window.requestAnimationFrame=function(callback,element){var currTime=new Date().getTime();var timeToCall=Math.max(0,16-(currTime-lastTime));var id=window.setTimeout(function(){callback(currTime+timeToCall);},timeToCall);lastTime=currTime+timeToCall;return id;};}
if(!window.cancelAnimationFrame)
window.cancelAnimationFrame=function(id){clearTimeout(id);};}());Bk.Util.hideURLBar();if(document.documentElement["getBoundingClientRect"])(function(){Bk.offset=function(elt){if(!elt){return{top:0,left:0};}
if(elt===elt.ownerDocument.body){console.warn("We do not handle offset.bodyOffset");return{top:0,left:0};}
Bk.animation._supportInitialized||Bk.animation._initializeSupport();var box=elt.getBoundingClientRect(),doc=elt.ownerDocument,win=Bk.Util.getWindow(doc),docElem=doc.documentElement,clientTop=docElem.clientTop||0,clientLeft=docElem.clientLeft||0,top=box.top+(win.pageYOffset||Bk.boxModel&&docElem.scrollTop)-clientTop,left=box.left+(win.pageXOffset||Bk.boxModel&&docElem.scrollLeft)-clientLeft;return{top:top,left:left};};})();})();if(typeof Array.prototype.filter!=="function"){Array.prototype.filter=function(fn,thisp){if(this===null)throw new TypeError;if(typeof fn!=="function")throw new TypeError;var result=[];for(var i=0;i<this.length;i++){if(i in this){var val=this[i];if(fn.call(thisp,val,i,this)){result.push(val);}}}
return result;};}
Array.prototype.remove=function(from,to){var rest=this.slice((to||from)+1||this.length);this.length=from<0?this.length+from:from;return this.push.apply(this,rest);};Element.prototype.hasClass=function(className){var reg=new RegExp('(\\s|^)'+className+'(\\s|$)');return reg.test(this.className);}
Element.prototype.addClass=function(className){if(this.hasClass(className)===false){this.className+=" "+className;}}
Element.prototype.removeClass=function(className){if(this.hasClass(className)===true){var reg=new RegExp('(\\s|^)'+className+'(\\s|$)');this.className=this.className.replace(reg,' ');}}
Element.prototype.toggleClass=function(className){if(this.hasClass(className)===true){this.removeClass(className);}else{this.addClass(className);}
if(Bk.Util.isEmpty(this.className)){this.removeAttribute("class");}}
if(window.ActiveXObject)(function(){(function(f){window.setTimeout=f(window.setTimeout);window.setInterval=f(window.setInterval);})
(function(f){return function(c,t){var a=[].slice.call(arguments,2);return f(function(){c.apply(this,a);},t);};});});if(typeof"".trim==="undefined"){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"");}}